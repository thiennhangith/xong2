<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá th·ªëng X√©t tuy·ªÉn ƒêH 2025 - T√≠ch h·ª£p Gemini AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 13px;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.4;
        }

        /* Header ch√≠nh th·ª©c */
        .header {
            background: linear-gradient(to bottom, #1e5799 0%, #2989d8 50%, #207cca 51%, #7db9e8 100%);
            color: white;
            padding: 6px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: 3px solid #1e5799;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo {
            width: 48px;
            height: 48px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1e5799;
            font-size: 9px;
            border: 2px solid #fff;
            text-align: center;
            line-height: 1.0;
        }

        .site-title {
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            line-height: 1.2;
        }

        .site-subtitle {
            font-size: 10px;
            opacity: 0.9;
            margin-top: 1px;
        }

        .hotline {
            background: #d9534f;
            padding: 5px 10px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 2px 5px rgba(217,85,79,0.3);
            white-space: nowrap;
            cursor: pointer;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Navigation */
        .nav-bar {
            background: #fff;
            border-bottom: 1px solid #ddd;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
            position: relative;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            background: #f8f9fa;
            border-radius: 4px;
            margin: 5px 0;
            overflow: hidden;
        }

        .nav-menu li {
            border-right: 1px solid #ddd;
        }

        .nav-menu li:last-child {
            border-right: none;
        }

        .nav-menu a {
            display: block;
            padding: 7px 12px;
            text-decoration: none;
            color: #337ab7;
            font-size: 10px;
            transition: all 0.3s;
            white-space: nowrap;
            cursor: pointer;
        }

        .nav-menu a:hover, .nav-menu a.active {
            background-color: #337ab7;
            color: white;
        }

        /* N√∫t HDSD - ƒë√£ s·ª≠a to h∆°n v√† r√µ h∆°n */
        .guide-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: #5cb85c;
            color: white;
            border: none;
            border-radius: 8px;
            width: 65px;
            height: 45px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 3px 8px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .guide-btn:hover {
            background: #449d44;
            transform: translateY(-50%) scale(1.05);
        }

        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 10px auto;
            padding: 0 15px;
            display: flex;
            gap: 15px;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            height: fit-content;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .sidebar-header {
            background: #337ab7;
            color: white;
            padding: 8px 10px;
            font-weight: bold;
            border-radius: 3px 3px 0 0;
            font-size: 11px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            border-bottom: 1px solid #f0f0f0;
        }

        .sidebar-menu a {
            display: block;
            padding: 8px 10px;
            text-decoration: none;
            color: #337ab7;
            font-size: 10px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: #f5f5f5;
            color: #23527c;
            border-left: 3px solid #337ab7;
            padding-left: 7px;
        }

        /* Content */
        .content {
            flex: 1;
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .user-info {
            background: #d9edf7;
            border: 1px solid #bce8f1;
            padding: 7px 10px;
            border-radius: 3px;
            margin-bottom: 15px;
            font-weight: bold;
            color: #31708f;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 13px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            text-align: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 3px;
            border-left: 4px solid #337ab7;
        }

        /* Form Styles */
        .form-section {
            margin-bottom: 18px;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            background: #fafafa;
        }

        .form-section h4 {
            background: #337ab7;
            color: white;
            padding: 7px 10px;
            margin: 0 0 10px 0;
            border-radius: 3px 3px 0 0;
            font-size: 11px;
        }

        .form-content {
            padding: 10px;
        }

        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: end;
        }

        .form-group {
            flex: 1;
        }

        .form-group.small {
            flex: 0 0 100px;
        }
        
        .form-group.action-buttons {
            flex: 0 0 auto;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 3px;
            color: #333;
            font-size: 10px;
            display: block;
        }

        .form-control {
            width: 100%;
            padding: 5px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 11px;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: #337ab7;
            outline: none;
            box-shadow: 0 0 5px rgba(51, 122, 183, 0.3);
        }

        .required {
            color: #d9534f;
        }

        /* Info cards v·ªõi ch·ªânh s·ª≠a */
        .info-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            padding: 8px;
            margin-bottom: 8px;
            font-size: 10px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: bold;
            color: #666;
        }

        .info-value {
            color: #333;
            flex: 1;
            margin: 0 10px;
        }

        .edit-btn {
            background: #5bc0de;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 2px 6px;
            font-size: 9px;
            cursor: pointer;
        }

        .edit-btn:hover {
            background: #46b8da;
        }

        .edit-input {
            display: none;
            width: 100%;
            padding: 2px 4px;
            font-size: 10px;
            border: 1px solid #ccc;
            border-radius: 2px;
        }

        .edit-controls {
            display: none;
            gap: 3px;
        }

        .save-btn {
            background: #5cb85c;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 2px 6px;
            font-size: 9px;
            cursor: pointer;
        }

        .cancel-btn {
            background: #d9534f;
            color: white;
            border: none;
            border-radius: 2px;
            padding: 2px 6px;
            font-size: 9px;
            cursor: pointer;
        }

        /* Wish container v·ªõi drag & drop */
        .wish-header {
            background: #f8f9fa;
            padding: 8px;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .wish-stats {
            font-size: 10px;
            color: #666;
        }

        .wish-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            background: white;
            position: relative;
        }

        .wish-item {
            background: #f9f9f9;
            border-bottom: 1px solid #e0e0e0;
            padding: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-size: 10px;
            position: relative;
            cursor: default;
        }

        .wish-item:hover {
            background-color: #e6f3ff;
        }

        .wish-item:last-child {
            border-bottom: none;
        }

        .wish-item.dragging {
            opacity: 0.8;
            background-color: #fff3cd;
            transform: rotate(2deg);
            z-index: 1000;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .wish-item.drag-over {
            border-top: 3px solid #337ab7;
            background-color: #e6f3ff;
        }

        .drag-handle {
            background: #6c757d;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            font-size: 12px;
            flex-shrink: 0;
            user-select: none;
        }

        .drag-handle:active {
            cursor: grabbing;
        }

        .wish-number {
            background: #337ab7;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 10px;
            flex-shrink: 0;
        }

        .wish-content {
            flex: 1;
        }

        .wish-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 2px;
        }

        .wish-details {
            color: #666;
            font-size: 9px;
        }

        .remove-wish {
            background: #d9534f;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 6px;
            font-size: 9px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .remove-wish:hover {
            background: #c9302c;
        }

        /* Payment section */
        .payment-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 3px;
            padding: 10px;
            margin: 10px 0;
        }

        .payment-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 11px;
        }

        .payment-total {
            font-weight: bold;
            color: #d9534f;
            font-size: 13px;
        }

        /* Buttons */
        .btn {
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            margin: 2px;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: #337ab7;
            color: white;
            border: 1px solid #2e6da4;
        }

        .btn-primary:hover {
            background-color: #286090;
            transform: translateY(-1px);
        }

        .btn-success {
            background-color: #5cb85c;
            color: white;
            border: 1px solid #4cae4c;
        }

        .btn-warning {
            background-color: #f0ad4e;
            color: white;
        }

        .btn-info {
            background-color: #5bc0de;
            color: white;
        }

        .btn-sm {
            padding: 3px 6px;
            font-size: 10px;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            background-color: #a0a0a0;
        }
        
        /* B·ªï sung style cho loading container */
        #processLoadingContainer {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Alert */
        .alert {
            padding: 8px 10px;
            margin-bottom: 12px;
            border: 1px solid transparent;
            border-radius: 3px;
            font-size: 11px;
        }

        .alert-info {
            color: #31708f;
            background-color: #d9edf7;
            border-color: #bce8f1;
        }

        .alert-warning {
            color: #8a6d3b;
            background-color: #fcf8e3;
            border-color: #faebcc;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        .loading-gemini {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            flex-direction: column;
            gap: 10px;
            color: #666;
        }
        .loading-gemini .spinner {
             width: 40px;
             height: 40px;
             border: 4px solid #f3f3f3;
             border-top: 4px solid #337ab7;
             border-radius: 50%;
             animation: spin 1s linear infinite;
        }


        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 5px;
            width: 95%;
            max-width: 1000px;
            max-height: 95vh;
            overflow: hidden;
            animation: modalSlide 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            background: #337ab7;
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 13px;
            font-weight: bold;
        }

        .modal-body {
            padding: 15px;
            max-height: 75vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: 10px 15px;
            background: #f8f9fa;
            text-align: center;
            border-top: 1px solid #e0e0e0;
        }

        @keyframes modalSlide {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.8;
        }

        .close:hover {
            opacity: 1;
        }

        /* Results */
        .result-success {
            background: #dff0d8;
            border: 1px solid #d6e9c6;
            color: #3c763d;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
            text-align: center;
        }

        .result-fail {
            background: #f2dede;
            border: 1px solid #ebccd1;
            color: #a94442;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
            text-align: center;
        }

        .celebration {
            font-size: 36px;
            text-align: center;
            margin: 10px 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            80% { transform: translateY(-2px); }
        }

        /* Data table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
            margin: 8px 0;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #ddd;
            padding: 5px;
            text-align: left;
            vertical-align: top;
        }

        .data-table th {
            background-color: #337ab7;
            color: white;
            font-weight: bold;
            text-align: center;
        }

        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .data-table tr:hover {
            background-color: #e6f3ff;
        }

        /* Certificate */
        .admission-certificate {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #337ab7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .admission-certificate::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7);
            border-radius: 8px 8px 0 0;
        }

        .university-logo {
            width: 60px;
            height: 60px;
            background: #337ab7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff6b6b;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 9999;
            animation: toastSlide 0.3s ease;
            font-size: 14px;
            max-width: 300px;
        }

        @keyframes toastSlide {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast.fade-out {
            animation: toastFade 0.3s ease forwards;
        }

        @keyframes toastFade {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }

        /* Footer */
        .footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 8px 0;
            margin-top: 20px;
            font-size: 10px;
        }

        /* Responsive - T·ªêI ∆ØU CHO DI ƒê·ªòNG */
        @media (max-width: 768px) {
            body {
                font-size: 14px; /* TƒÉng font ch·ªØ g·ªëc cho d·ªÖ ƒë·ªçc */
            }
            .main-container {
                flex-direction: column;
                gap: 10px;
                padding: 0 5px;
                margin-top: 5px;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
            }
            .nav-menu li {
                flex-grow: 1;
                text-align: center;
            }
            .nav-menu a {
                font-size: 11px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 8px;
            }

            .header-container {
                flex-direction: column;
                gap: 8px;
                padding: 10px 15px;
                text-align: center;
            }
            .site-title {
                font-size: 13px;
            }
            .hotline {
                font-size: 11px;
            }
            .nav-container {
                padding: 0 10px;
            }
            .guide-btn {
                position: relative;
                transform: none;
                top: auto;
                right: auto;
                display: block;
                width: 100%;
                margin: 10px 0 5px 0;
                height: 40px;
            }
            .user-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            .wish-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .wish-content {
                width: 100%;
            }
            .remove-wish {
                align-self: flex-end;
            }
            .modal-content {
                width: 100%;
                margin: 0;
                height: 100%;
                max-height: 100vh;
                border-radius: 0;
            }
            .modal-body {
                max-height: calc(100vh - 110px); /* Adjust for header/footer */
            }
            .content {
                padding: 10px;
            }

            /* Responsive Tables - Chuy·ªÉn b·∫£ng th√†nh d·∫°ng card */
            .data-table {
                border: none;
            }
            .data-table thead {
                display: none; /* ·∫®n ti√™u ƒë·ªÅ b·∫£ng */
            }
            .data-table tr {
                display: block;
                margin-bottom: 15px;
                border: 1px solid #ddd;
                border-radius: 4px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                background: white;
                padding: 5px;
            }
            .data-table td {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px;
                text-align: right; /* CƒÉn ph·∫£i n·ªôi dung */
                border-bottom: 1px solid #f0f0f0;
                font-size: 12px;
            }
            .data-table td:last-child {
                border-bottom: none;
            }
            .data-table td::before {
                content: attr(data-label); /* L·∫•y n·ªôi dung t·ª´ attribute data-label */
                font-weight: bold;
                text-align: left; /* CƒÉn tr√°i nh√£n */
                margin-right: 10px;
                color: #337ab7;
                flex-shrink: 0;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-container">
            <div class="logo-section">
                <div class="logo">BGD<br>&ƒêT</div>
                <div>
                    <div class="site-title">H·ªÜ TH·ªêNG QU·∫¢N L√ù THI T·ªêT NGHI·ªÜP THPT</div>
                    <div class="site-subtitle">B·ªô Gi√°o d·ª•c v√† ƒê√†o t·∫°o</div>
                </div>
            </div>
            <div class="hotline" onclick="showDecorativeAlert()">üìû HOTLINE: 1800 8000 - 2</div>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-container">
            <ul class="nav-menu">
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()" class="active">üè† Trang ch·ªß</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìù Phi·∫øu ƒëƒÉng k√Ω</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üîç Tra c·ª©u ƒëi·ªÉm</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üéØ ƒêƒÉng k√Ω nguy·ªán v·ªçng</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìä Tra c·ª©u k·∫øt qu·∫£</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üîë ƒê·ªïi m√£ ƒëƒÉng nh·∫≠p</a></li>
            </ul>
            <button class="guide-btn" onclick="showGuide()" title="H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng">HDSD</button>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-header">MENU CH·ª®C NƒÇNG</div>
            <ul class="sidebar-menu">
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()" class="active">üè† Trang ch·ªß</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìù Phi·∫øu ƒëƒÉng k√Ω</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìã Phi·∫øu ƒëƒÉng k√Ω chi ti·∫øt</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">‚úèÔ∏è S·ª≠a email v√† s·ªë ƒëi·ªán tho·∫°i</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üîç Tra c·ª©u</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìÑ Tra c·ª©u gi·∫•y b√°o d·ª± thi</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìä Tra c·ª©u ƒëi·ªÉm</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üî¢ Tra c·ª©u m√£ x√©t tuy·ªÉn theo ƒë·ª£t</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üìö H·ªçc b·∫° THPT</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üß† Tra c·ª©u ƒëi·ªÉm thi ƒêGNL/T∆∞ duy</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üèÜ Tra c·ª©u th√¥ng tin tuy·ªÉn th·∫≥ng</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">‚úÖ Tra c·ª©u k·∫øt qu·∫£ s∆° tuy·ªÉn</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üåê Danh s√°ch ch·ª©ng ch·ªâ ngo·∫°i ng·ªØ</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üéØ ƒêƒÉng k√Ω th√¥ng tin x√©t tuy·ªÉn sinh</a></li>
                <li><a href="javascript:void(0)" onclick="showDecorativeAlert()">üîë ƒê·ªïi m√£ ƒëƒÉng nh·∫≠p</a></li>
            </ul>
        </div>

        <div class="content">
            <div class="user-info">
                <div style="display: flex; align-items: center; flex: 1;">
                    <span>üë§ <strong id="userName">NGUY·ªÑN VƒÇN A</strong></span>
                    <input type="text" id="editNameInput" class="form-control" style="display: none; margin-left: 10px; width: 200px;">
                    <div id="editNameButtons" style="display: none; margin-left: 10px; gap: 5px;">
                        <button class="btn btn-success btn-sm" onclick="saveNewName()">‚úÖ</button>
                        <button class="btn btn-warning btn-sm" onclick="cancelEditName()">‚ùå</button>
                    </div>
                </div>
                <div>
                    <button class="btn btn-info btn-sm" id="editNameBtn" onclick="editName()">‚úèÔ∏è S·ª≠a t√™n</button>
                    <span style="margin-left: 10px; font-size: 10px;">- Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi h·ªá th·ªëng x√©t tuy·ªÉn 2025</span>
                </div>
            </div>

            <div class="page-title">üéì H·ªÜ TH·ªêNG X√âT TUY·ªÇN ƒê·∫†I H·ªåC 2025 (T√≠ch h·ª£p Gemini AI)</div>

            <div class="alert alert-info">
                <strong>üì¢ PHI√äN B·∫¢N N√ÇNG C·∫§P V·ªöI GEMINI AI:</strong><br>
                ‚Ä¢ <strong>‚ú® M·ªöI:</strong> Nh·∫≠n t∆∞ v·∫•n chi·∫øn l∆∞·ª£c s·∫Øp x·∫øp nguy·ªán v·ªçng t·ª´ AI.<br>
                ‚Ä¢ <strong>‚ú® M·ªöI:</strong> Tra c·ª©u th√¥ng tin chi ti·∫øt v·ªÅ ng√†nh h·ªçc b·∫•t k·ª≥.<br>
                ‚Ä¢ Gi·ªØ nguy√™n 4 tr∆∞·ªùng ƒë·∫°i h·ªçc, d·ªØ li·ªáu ƒëi·ªÉm chu·∫©n 2024 v√† t·∫•t c·∫£ t√≠nh nƒÉng c·ªët l√µi.
            </div>

            <div class="form-section">
                <h4>üìã I. TH√îNG TIN C√Å NH√ÇN (C√≥ th·ªÉ ch·ªânh s·ª≠a)</h4>
                <div class="form-content">
                    <div class="info-card">
                        <div class="info-row">
                            <span class="info-label">H·ªç v√† t√™n:</span>
                            <span class="info-value" id="userNameInfo">NGUY·ªÑN VƒÇN A</span>
                            <input type="text" class="edit-input" id="editUserName" value="NGUY·ªÑN VƒÇN A">
                            <div class="edit-controls">
                                <button class="save-btn" onclick="saveInfo('userNameInfo', 'editUserName')">‚úì</button>
                                <button class="cancel-btn" onclick="cancelEdit('userNameInfo', 'editUserName')">‚úï</button>
                            </div>
                            <button class="edit-btn" onclick="editInfo('userNameInfo', 'editUserName')">‚úèÔ∏è</button>
                        </div>
                        <div class="info-row">
                            <span class="info-label">S·ªë h·ªì s∆°:</span>
                            <span class="info-value" id="studentId">123456</span>
                            <input type="text" class="edit-input" id="editStudentId" value="123456">
                            <div class="edit-controls">
                                <button class="save-btn" onclick="saveInfo('studentId', 'editStudentId')">‚úì</button>
                                <button class="cancel-btn" onclick="cancelEdit('studentId', 'editStudentId')">‚úï</button>
                            </div>
                            <button class="edit-btn" onclick="editInfo('studentId', 'editStudentId')">‚úèÔ∏è</button>
                        </div>
                        <div class="info-row">
                            <span class="info-label">N∆°i sinh:</span>
                            <span class="info-value" id="birthPlace">H√† N·ªôi</span>
                            <input type="text" class="edit-input" id="editBirthPlace" value="H√† N·ªôi">
                            <div class="edit-controls">
                                <button class="save-btn" onclick="saveInfo('birthPlace', 'editBirthPlace')">‚úì</button>
                                <button class="cancel-btn" onclick="cancelEdit('birthPlace', 'editBirthPlace')">‚úï</button>
                            </div>
                            <button class="edit-btn" onclick="editInfo('birthPlace', 'editBirthPlace')">‚úèÔ∏è</button>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Tr∆∞·ªùng THPT:</span>
                            <span class="info-value" id="highSchool">THPT Hogwarts</span>
                            <input type="text" class="edit-input" id="editHighSchool" value="THPT Hogwarts">
                            <div class="edit-controls">
                                <button class="save-btn" onclick="saveInfo('highSchool', 'editHighSchool')">‚úì</button>
                                <button class="cancel-btn" onclick="cancelEdit('highSchool', 'editHighSchool')">‚úï</button>
                            </div>
                            <button class="edit-btn" onclick="editInfo('highSchool', 'editHighSchool')">‚úèÔ∏è</button>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Khu v·ª±c:</span>
                            <span class="info-value">
                                <select id="areaSelect" class="form-control" style="width: auto; font-size: 10px;" onchange="updateAreaInfo()">
                                    <option value="KV1">KV1 - X√£ mi·ªÅn n√∫i, v√πng ƒë·∫∑c bi·ªát kh√≥ khƒÉn (+0.75 ƒëi·ªÉm)</option>
                                    <option value="KV2NT" selected>KV2-NT - Khu v·ª±c 2 n√¥ng th√¥n (+0.5 ƒëi·ªÉm)</option>
                                    <option value="KV2">KV2 - Th·ªã x√£, th√†nh ph·ªë tr·ª±c thu·ªôc t·ªânh (+0.25 ƒëi·ªÉm)</option>
                                    <option value="KV3">KV3 - Qu·∫≠n n·ªôi th√†nh th√†nh ph·ªë TT TW (0 ƒëi·ªÉm)</option>
                                </select>
                            </span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">ƒêi·ªÉm ∆∞u ti√™n hi·ªán t·∫°i:</span>
                            <span class="info-value" id="currentBonusInfo">+0.5 ƒëi·ªÉm (gi·∫£m d·∫ßn n·∫øu t·ªïng ƒëi·ªÉm ‚â•22.5)</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h4>üìä THAM KH·∫¢O ƒêI·ªÇM CHU·∫®N NƒÇM 2024</h4>
                <div class="form-content">
                    <div style="text-align: center; margin-bottom: 10px;">
                        <button type="button" class="btn btn-info btn-sm" onclick="showCutoff2024('UIT')">
                            üìà UIT 2024
                        </button>
                        <button type="button" class="btn btn-info btn-sm" onclick="showCutoff2024('HCMUS')">
                            üìà HCMUS 2024
                        </button>
                        <button type="button" class="btn btn-info btn-sm" onclick="showCutoff2024('SPKT')">
                            üìà SPKT 2024
                        </button>
                        <button type="button" class="btn btn-info btn-sm" onclick="showCutoff2024('FPT')">
                            üìà FPT 2024
                        </button>
                    </div>
                    <p style="font-size: 10px; text-align: center; color: #666;">
                        üí° Tham kh·∫£o ƒë·ªÉ c√≥ chi·∫øn l∆∞·ª£c ƒëƒÉng k√Ω nguy·ªán v·ªçng h·ª£p l√Ω
                    </p>
                </div>
            </div>

            <div class="form-section">
                <h4>üìä II. ƒêI·ªÇM THI T·ªêT NGHI·ªÜP THPT 2025</h4>
                <div class="form-content">
                    <div class="alert alert-warning" style="margin-bottom: 10px;">
                        <strong>‚ö†Ô∏è L∆∞u √Ω:</strong> Ch·ªâ h·ªó tr·ª£ ƒëi·ªÉm thi THPT Qu·ªëc gia. ƒêi·ªÉm nh·∫≠p l√† ƒëi·ªÉm g·ªëc (thang 10).
                    </div>
                    
                    <form id="scoreForm" oninput="checkGeminiButtons()">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="toan">üìê To√°n (b·∫Øt bu·ªôc) <span class="required">*</span>:</label>
                                <input type="number" id="toan" class="form-control" min="0" max="10" step="0.01" placeholder="0.00" required>
                            </div>
                            <div class="form-group">
                                <label for="van">üìñ Ng·ªØ vƒÉn (b·∫Øt bu·ªôc) <span class="required">*</span>:</label>
                                <input type="number" id="van" class="form-control" min="0" max="10" step="0.01" placeholder="0.00" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="subject1">üéØ M√¥n t·ª± ch·ªçn 1 <span class="required">*</span>:</label>
                                <select id="subject1" class="form-control" required onchange="updateSubjectInputs()">
                                    <option value="">-- Ch·ªçn m√¥n --</option>
                                    <option value="anh">Ti·∫øng Anh</option>
                                    <option value="ly">V·∫≠t l√Ω</option>
                                    <option value="hoa">H√≥a h·ªçc</option>
                                    <option value="sinh">Sinh h·ªçc</option>
                                    <option value="su">L·ªãch s·ª≠</option>
                                    <option value="dia">ƒê·ªãa l√Ω</option>
                                    <option value="gdkt">GDKT & PL</option>
                                    <option value="tin">Tin h·ªçc</option>
                                    <option value="congnghe">C√¥ng ngh·ªá</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="score1">ƒêi·ªÉm m√¥n 1 <span class="required">*</span>:</label>
                                <input type="number" id="score1" class="form-control" min="0" max="10" step="0.01" placeholder="0.00" required disabled>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="subject2">üéØ M√¥n t·ª± ch·ªçn 2 <span class="required">*</span>:</label>
                                <select id="subject2" class="form-control" required onchange="updateSubjectInputs()">
                                    <option value="">-- Ch·ªçn m√¥n --</option>
                                    <option value="anh">Ti·∫øng Anh</option>
                                    <option value="ly">V·∫≠t l√Ω</option>
                                    <option value="hoa">H√≥a h·ªçc</option>
                                    <option value="sinh">Sinh h·ªçc</option>
                                    <option value="su">L·ªãch s·ª≠</option>
                                    <option value="dia">ƒê·ªãa l√Ω</option>
                                    <option value="gdkt">GDKT & PL</option>
                                    <option value="tin">Tin h·ªçc</option>
                                    <option value="congnghe">C√¥ng ngh·ªá</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="score2">ƒêi·ªÉm m√¥n 2 <span class="required">*</span>:</label>
                                <input type="number" id="score2" class="form-control" min="0" max="10" step="0.01" placeholder="0.00" required disabled>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="form-section">
                <h4>üéØ III. ƒêƒÇNG K√ù NGUY·ªÜN V·ªåNG (4 TR∆Ø·ªúNG ƒê·∫†I H·ªåC)</h4>
                <div class="form-content">
                    <div class="wish-header">
                        <div>
                            <strong>üìã Danh s√°ch nguy·ªán v·ªçng (K√©o th·∫£ ƒë·ªÉ ƒë·ªïi v·ªã tr√≠)</strong>
                        </div>
                        <div class="wish-stats">
                            <span>T·ªïng: <strong id="totalWishes">0</strong></span>
                        </div>
                    </div>

                    <div style="margin-bottom: 8px;">
                        <div class="form-row">
                            <div class="form-group">
                                <select id="schoolSelect" class="form-control" onchange="updateMajorSelect()">
                                    <option value="">-- Ch·ªçn tr∆∞·ªùng tr∆∞·ªõc --</option>
                                    <option value="UIT">üè´ ƒê·∫°i h·ªçc C√¥ng ngh·ªá Th√¥ng tin (UIT)</option>
                                    <option value="HCMUS">üè´ ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n (HCMUS)</option>
                                    <option value="SPKT">üè´ ƒê·∫°i h·ªçc S∆∞ ph·∫°m K·ªπ thu·∫≠t TPHCM (SPKT)</option>
                                    <option value="FPT">üè´ ƒê·∫°i h·ªçc FPT TPHCM (FPT)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <select id="majorSelect" class="form-control" disabled onchange="checkGeminiButtons()">
                                    <option value="">-- Ch·ªçn ng√†nh --</option>
                                </select>
                            </div>
                            <div class="form-group action-buttons" style="display: flex; gap: 5px;">
                                <button type="button" class="btn btn-success btn-sm" onclick="addWish()">‚ûï Th√™m</button>
                                <button type="button" class="btn btn-info btn-sm" id="geminiMajorInfoBtn" onclick="getMajorInfo()" disabled>‚ú® T√¨m hi·ªÉu ng√†nh</button>
                                <button type="button" class="btn btn-warning btn-sm" onclick="clearAllWishes()">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
                            </div>
                        </div>
                    </div>

                    <div class="wish-container" id="wishContainer">
                        <div style="text-align: center; color: #666; padding: 15px;">
                            <p>üéØ <strong>Ch∆∞a c√≥ nguy·ªán v·ªçng n√†o</strong></p>
                            <p style="font-size: 9px;">Ch·ªçn tr∆∞·ªùng v√† ng√†nh, nh·∫•n "Th√™m" ƒë·ªÉ b·∫Øt ƒë·∫ßu!</p>
                        </div>
                    </div>

                    <div class="payment-section" id="paymentSection" style="display: none;">
                        <h5 style="margin-bottom: 8px; color: #8a6d3b;">üí≥ THANH TO√ÅN NGUY·ªÜN V·ªåNG (GI·∫¢ L·∫¨P)</h5>
                        <div class="payment-info">
                            <span>S·ªë nguy·ªán v·ªçng: <strong id="paymentWishCount">0</strong></span>
                            <span>ƒê∆°n gi√°: <strong>15,000 VNƒê (gi·∫£)</strong></span>
                            <span class="payment-total">T·ªïng: <span id="paymentTotal">0 VNƒê</span></span>
                        </div>
                        <div style="text-align: center;">
                            <button type="button" class="btn btn-warning btn-sm" onclick="processPayment()">
                                üí∞ THANH TO√ÅN GI·∫¢ L·∫¨P
                            </button>
                        </div>
                    </div>

                    <div style="margin-top: 10px; text-align: center;">
                        <button type="button" class="btn btn-primary" id="submitBtn" onclick="processAdmissionComplete()" disabled>
                             <span id="submitBtnText">üöÄ X√âT TUY·ªÇN 2025</span>
                             <span id="processLoadingContainer" style="display: none;">
                                 <span class="loading"></span>
                                 <span>ƒêang x·ª≠ l√Ω h·ªì s∆°...</span>
                             </span>
                        </button>
                        <button type="button" class="btn btn-success" id="geminiStrategyBtn" onclick="getStrategicAdvice()" disabled>‚ú® T∆∞ v·∫•n chi·∫øn l∆∞·ª£c NV</button>
                        <button type="button" class="btn btn-info btn-sm" onclick="fillSampleData()">üìù D·ªØ li·ªáu m·∫´u</button>
                        <button type="button" class="btn btn-warning btn-sm" onclick="resetAll()">üîÑ Reset</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h4>‚ú® Tr·ª£ l√Ω AI S·∫Øp x·∫øp Nguy·ªán v·ªçng</h4>
                <div class="form-content">
                     <p style="font-size: 10px; color: #666; margin-bottom: 10px;">
                        Ch∆∞a bi·∫øt n√™n s·∫Øp x·∫øp nguy·ªán v·ªçng ra sao? H√£y ch·ªçn 2 ng√†nh b·∫°n m∆° ∆∞·ªõc nh·∫•t, AI s·∫Ω t·ª± ƒë·ªông t·∫°o m·ªôt danh s√°ch nguy·ªán v·ªçng t·ªëi ∆∞u d·ª±a tr√™n ƒëi·ªÉm s·ªë c·ªßa b·∫°n!
                    </p>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="aiWish1"><strong>Nguy·ªán v·ªçng 1 (M∆° ∆∞·ªõc nh·∫•t):</strong></label>
                            <select id="aiWish1" class="form-control"></select>
                        </div>
                         <div class="form-group">
                            <label for="aiWish2"><strong>Nguy·ªán v·ªçng 2 (M∆° ∆∞·ªõc th·ª© hai):</strong></label>
                            <select id="aiWish2" class="form-control"></select>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 10px;">
                        <button type="button" class="btn btn-primary" id="aiArrangeBtn" onclick="getAiArrangement()">ƒê·ªÉ AI S·∫Øp x·∫øp gi√∫p b·∫°n</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="guideModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üìö H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG H·ªÜ TH·ªêNG</div>
                <span class="close" onclick="closeGuideModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div style="background: #d9edf7; border: 1px solid #bce8f1; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                    <h4 style="color: #31708f; margin-bottom: 8px;">üëã CH√ÄO M·ª™NG B·∫†N ƒê·∫æN V·ªöI H·ªÜ TH·ªêNG M√î PH·ªéNG X√âT TUY·ªÇN 2025!</h4>
                    <p style="font-size: 11px; color: #31708f;">
                        C√¥ng c·ª• n√†y ƒë∆∞·ª£c t·∫°o ra ƒë·ªÉ gi√∫p b·∫°n <strong>tr·∫£i nghi·ªám th·ª≠</strong> quy tr√¨nh x√©t tuy·ªÉn ƒê·∫°i h·ªçc, t·ª´ vi·ªác nh·∫≠p ƒëi·ªÉm, ƒëƒÉng k√Ω nguy·ªán v·ªçng cho ƒë·∫øn xem k·∫øt qu·∫£.
                        <br><strong>L∆∞u √Ω quan tr·ªçng:</strong> ƒê√¢y l√† h·ªá th·ªëng <strong>M√î PH·ªéNG</strong>, kh√¥ng ph·∫£i website ch√≠nh th·ª©c c·ªßa B·ªô GD&ƒêT. M·ªçi k·∫øt qu·∫£ ch·ªâ mang t√≠nh ch·∫•t tham kh·∫£o v√† gi·∫£i tr√≠.
                    </p>
                </div>

                <h5 style="color: #337ab7; margin: 15px 0 8px 0;">üìã C√ÅC B∆Ø·ªöC TH·ª∞C HI·ªÜN (4 B∆Ø·ªöC ƒê∆†N GI·∫¢N)</h5>
                <ol style="font-size: 11px; margin-left: 20px; line-height: 1.6;">
                    <li><strong>B∆∞·ªõc 1: Nh·∫≠p th√¥ng tin & ƒêi·ªÉm thi</strong>
                        <br>ƒêi·ªÅn ƒëi·ªÉm thi T·ªët nghi·ªáp THPT c·ªßa b·∫°n v√†o c√°c √¥ t∆∞∆°ng ·ª©ng. H·ªá th·ªëng ch·ªâ y√™u c·∫ßu 4 m√¥n: To√°n, VƒÉn (b·∫Øt bu·ªôc) v√† 2 m√¥n t·ª± ch·ªçn. B·∫°n c≈©ng c√≥ th·ªÉ ch·ªânh s·ª≠a th√¥ng tin c√° nh√¢n v√† khu v·ª±c ∆∞u ti√™n.
                    </li>
                    <li><strong>B∆∞·ªõc 2: Th√™m & S·∫Øp x·∫øp Nguy·ªán v·ªçng</strong>
                        <br>Ch·ªçn tr∆∞·ªùng v√† ng√†nh b·∫°n y√™u th√≠ch, sau ƒë√≥ nh·∫•n "Th√™m". B·∫°n c√≥ th·ªÉ th√™m nhi·ªÅu nguy·ªán v·ªçng. D√πng chu·ªôt <strong>k√©o v√† th·∫£</strong> c√°c nguy·ªán v·ªçng ƒë·ªÉ s·∫Øp x·∫øp l·∫°i th·ª© t·ª± ∆∞u ti√™n.
                    </li>
                    <li><strong>B∆∞·ªõc 3: Thanh to√°n (Gi·∫£ l·∫≠p)</strong>
                        <br>Sau khi th√™m nguy·ªán v·ªçng, b·∫°n c·∫ßn th·ª±c hi·ªán thanh to√°n gi·∫£ l·∫≠p v·ªõi chi ph√≠ 15.000ƒë/nguy·ªán v·ªçng. ƒê√¢y ch·ªâ l√† m√¥ ph·ªèng, <strong>b·∫°n kh√¥ng m·∫•t ti·ªÅn th·∫≠t</strong>.
                    </li>
                    <li><strong>B∆∞·ªõc 4: X√©t tuy·ªÉn & Xem k·∫øt qu·∫£</strong>
                        <br>Khi ƒë√£ s·∫µn s√†ng, nh·∫•n n√∫t "X√âT TUY·ªÇN 2025". H·ªá th·ªëng s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ k·∫øt qu·∫£ chi ti·∫øt, cho b·∫°n bi·∫øt b·∫°n ƒë√£ tr√∫ng tuy·ªÉn nguy·ªán v·ªçng n√†o.
                    </li>
                </ol>

                <h5 style="color: #337ab7; margin: 15px 0 8px 0;">‚ú® T√çNH NƒÇNG M·ªöI V·ªöI GEMINI AI</h5>
                <ul style="font-size: 11px; margin-left: 20px; line-height: 1.6;">
                    <li><strong>T∆∞ v·∫•n chi·∫øn l∆∞·ª£c NV:</strong> Sau khi nh·∫≠p ƒëi·ªÉm v√† th√™m NV, nh·∫•n n√∫t "‚ú® T∆∞ v·∫•n chi·∫øn l∆∞·ª£c NV", AI s·∫Ω ph√¢n t√≠ch v√† cho b·∫°n l·ªùi khuy√™n ƒë·ªÉ t·ªëi ∆∞u h√≥a c∆° h·ªôi.</li>
                    <li><strong>T√¨m hi·ªÉu ng√†nh:</strong> Ch·ªçn m·ªôt ng√†nh h·ªçc b·∫•t k·ª≥ v√† nh·∫•n n√∫t "‚ú® T√¨m hi·ªÉu ng√†nh" ƒë·ªÉ xem th√¥ng tin chi ti·∫øt v·ªÅ ng√†nh ƒë√≥ do AI t·ªïng h·ª£p.</li>
                </ul>

                <h5 style="color: #337ab7; margin: 15px 0 8px 0;">üí° M·∫∏O & PH√çM T·∫ÆT</h5>
                 <ul style="font-size: 11px; margin-left: 20px; line-height: 1.6;">
                    <li><strong>D·ªØ li·ªáu m·∫´u:</strong> Nh·∫•n n√∫t "D·ªØ li·ªáu m·∫´u" ƒë·ªÉ ƒëi·ªÅn nhanh ƒëi·ªÉm s·ªë v√† nguy·ªán v·ªçng v√≠ d·ª•.</li>
                    <li><strong>Ph√≠m t·∫Øt:</strong>
                        <ul>
                            <li><strong>F1:</strong> M·ªü h∆∞·ªõng d·∫´n n√†y.</li>
                            <li><strong>F2:</strong> S·ª≠a nhanh t√™n th√≠ sinh.</li>
                            <li><strong>Ctrl + Enter:</strong> Th·ª±c hi·ªán x√©t tuy·ªÉn (khi n√∫t ƒë√£ s√°ng).</li>
                            <li><strong>Esc:</strong> ƒê√≥ng t·∫•t c·∫£ c√°c c·ª≠a s·ªï pop-up.</li>
                        </ul>
                    </li>
                </ul>

                <div style="background: #d4edda; border: 1px solid #c3e6cb; padding: 10px; border-radius: 5px; margin-top: 15px;">
                    <p style="font-size: 11px; color: #155724; text-align: center;">
                        Ch√∫c c√°c b·∫°n th√≠ sinh c√≥ nh·ªØng tr·∫£i nghi·ªám th√∫ v·ªã v√† may m·∫Øn trong k·ª≥ thi th·∫≠t!<br>
                        <small>-NTTN-</small>
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success btn-sm" onclick="closeGuideModal()">‚úÖ ƒê√£ hi·ªÉu</button>
            </div>
        </div>
    </div>

    <div id="cutoff2024Modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="cutoffModalTitle">üìä B·∫¢NG ƒêI·ªÇM CHU·∫®N NƒÇM 2024</div>
                <span class="close" onclick="closeCutoff2024Modal()">&times;</span>
            </div>
            <div class="modal-body">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>STT</th>
                            <th>M√£ ng√†nh</th>
                            <th>T√™n ng√†nh</th>
                            <th>T·ªï h·ª£p x√©t tuy·ªÉn</th>
                            <th>ƒêi·ªÅu ki·ªán To√°n</th>
                            <th>ƒêi·ªÉm chu·∫©n 2024</th>
                        </tr>
                    </thead>
                    <tbody id="cutoff2024TableBody">
                        </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button class="btn btn-info btn-sm" onclick="closeCutoff2024Modal()">‚úÖ ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üéì K·∫æT QU·∫¢ X√âT TUY·ªÇN 2025</div>
                <span class="close" onclick="closeModal('resultModal')">&times;</span>
            </div>
            <div class="modal-body" id="modalBody">
                </div>
            <div class="modal-footer">
                <button class="btn btn-success btn-sm" onclick="closeModal('resultModal')">‚úÖ ƒê√≥ng</button>
                <button class="btn btn-info btn-sm" id="viewCutoff2025Btn" style="display: none;" onclick="showCutoff2025()">üìä Xem ƒëi·ªÉm chu·∫©n 2025</button>
                <button class="btn btn-warning btn-sm" id="viewRandomRatesBtn" style="display: none;" onclick="showRandomRates()">üé≤ T·ª∑ l·ªá random c·ªßa ch√∫ng t√¥i</button>
            </div>
        </div>
    </div>

    <div id="randomRatesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üé≤ T·ª∂ L·ªÜ RANDOM ƒêI·ªÇM CHU·∫®N 2025</div>
                <span class="close" onclick="closeModal('randomRatesModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ch·ªçn tr∆∞·ªùng:</label>
                            <select id="randomSchoolSelect" class="form-control" onchange="updateRandomMajorSelect()">
                                <option value="">-- Ch·ªçn tr∆∞·ªùng --</option>
                                <option value="UIT">üè´ ƒê·∫°i h·ªçc C√¥ng ngh·ªá Th√¥ng tin (UIT)</option>
                                <option value="HCMUS">üè´ ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n (HCMUS)</option>
                                <option value="SPKT">üè´ ƒê·∫°i h·ªçc S∆∞ ph·∫°m K·ªπ thu·∫≠t TPHCM (SPKT)</option>
                                <option value="FPT">üè´ ƒê·∫°i h·ªçc FPT TPHCM (FPT)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <select id="randomMajorSelect" class="form-control" disabled>
                                <option value="">-- Ch·ªçn ng√†nh --</option>
                            </select>
                        </div>
                        <div class="form-group small">
                            <button type="button" class="btn btn-primary btn-sm" onclick="showMajorRandomRate()">üìä Xem t·ª∑ l·ªá</button>
                        </div>
                    </div>
                </div>
                <div id="randomRateDisplay">
                    <p style="text-align: center; color: #666; font-style: italic;">
                        üéØ Ch·ªçn tr∆∞·ªùng v√† ng√†nh ƒë·ªÉ xem t·ª∑ l·ªá random ƒëi·ªÉm chu·∫©n<br>
                        <small>(FPT kh√¥ng c√≥ random - gi·ªØ nguy√™n ƒëi·ªÉm chu·∫©n 2024)</small>
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success btn-sm" onclick="closeModal('randomRatesModal')">‚úÖ ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <div id="cutoff2025Modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üìä B·∫¢NG ƒêI·ªÇM CHU·∫®N NƒÇM 2025</div>
                <span class="close" onclick="closeModal('cutoff2025Modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div style="background: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px; margin: 10px 0;">
                    <div style="background: #337ab7; color: white; padding: 10px; border-radius: 5px 5px 0 0; font-weight: bold; text-align: center;">
                        üé≤ ƒêI·ªÇM CHU·∫®N NƒÇM 2025 - K·∫æT QU·∫¢ RANDOM
                    </div>
                    <div style="padding: 15px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>Tr∆∞·ªùng</th>
                                    <th>M√£ ng√†nh</th>
                                    <th>T√™n ng√†nh</th>
                                    <th>DC 2024</th>
                                    <th>DC 2025</th>
                                    <th>So s√°nh</th>
                                </tr>
                            </thead>
                            <tbody id="cutoff2025TableBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-success btn-sm" onclick="closeModal('cutoff2025Modal')">‚úÖ ƒê√≥ng</button>
            </div>
        </div>
    </div>
    
    <div id="geminiModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="geminiModalTitle">‚ú® Tr·ª£ l√Ω AI Gemini</div>
                <span class="close" onclick="closeModal('geminiModal')">&times;</span>
            </div>
            <div class="modal-body" id="geminiModalBody">
                </div>
            <div class="modal-footer">
                <button class="btn btn-success btn-sm" onclick="closeModal('geminiModal')">‚úÖ ƒê√£ hi·ªÉu</button>
            </div>
        </div>
    </div>


    <div class="footer">
        H·ªá th·ªëng x√©t tuy·ªÉn | Kh√¥ng ph·∫£i website ch√≠nh th·ª©c c·ªßa B·ªô GD&ƒêT
    </div>

    <script>
        // D·ªÆ LI·ªÜU UIT - GI·ªÆ NGUY√äN
        const uitMajors = [
            {
                school: 'UIT',
                code: '7480107', 
                name: 'Tr√≠ tu·ªá nh√¢n t·∫°o', 
                cutoff2024: 28.3, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 0, increase_025_05: 5, increase_05_075: 15, increase_075_1: 30, increase_over_1: 50}
            },
            {
                school: 'UIT',
                code: '7460108', 
                name: 'Khoa h·ªçc D·ªØ li·ªáu', 
                cutoff2024: 27.5, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 7.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 5, increase_025_05: 15, increase_05_075: 30, increase_075_1: 40, increase_over_1: 10}
            },
            {
                school: 'UIT',
                code: '7480101', 
                name: 'Khoa h·ªçc m√°y t√≠nh', 
                cutoff2024: 27.3, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.5,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 5, increase_025_05: 15, increase_05_075: 35, increase_075_1: 35, increase_over_1: 10}
            },
            {
                school: 'UIT',
                code: '7480202', 
                name: 'An to√†n Th√¥ng tin', 
                cutoff2024: 26.77, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 10, increase_025_05: 20, increase_05_075: 40, increase_075_1: 25, increase_over_1: 5}
            },
            {
                school: 'UIT',
                code: '7480106', 
                name: 'K·ªπ thu·∫≠t M√°y t√≠nh', 
                cutoff2024: 26.25, 
                subjects: ['A00', 'A01'], 
                minMath: 6.5,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 10, increase_025_05: 30, increase_05_075: 40, increase_075_1: 15, increase_over_1: 5}
            },
            {
                school: 'UIT',
                code: '7480122', 
                name: 'Th∆∞∆°ng m·∫°i ƒêi·ªán t·ª≠', 
                cutoff2024: 26.12, 
                subjects: ['A00', 'A01', 'D01'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 40, increase_05_075: 30, increase_075_1: 10, increase_over_1: 0}
            },
            {
                school: 'UIT',
                code: '7480102', 
                name: 'M·∫°ng m√°y t√≠nh v√† Truy·ªÅn th√¥ng d·ªØ li·ªáu', 
                cutoff2024: 25.7, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 45, increase_05_075: 25, increase_075_1: 5, increase_over_1: 0}
            },
            {
                school: 'UIT',
                code: '7480104', 
                name: 'H·ªá th·ªëng Th√¥ng tin (Ch∆∞∆°ng tr√¨nh ti√™n ti·∫øn)', 
                cutoff2024: 25.55, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 40, increase_05_075: 30, increase_075_1: 10, increase_over_1: 0}
            },
            {
                school: 'UIT',
                code: '7480201', 
                name: 'C√¥ng ngh·ªá Th√¥ng tin (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', 
                cutoff2024: 25.55, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 10, increase_025_05: 25, increase_05_075: 40, increase_075_1: 20, increase_over_1: 5}
            },
            {
                school: 'UIT',
                code: '7480103', 
                name: 'K·ªπ thu·∫≠t Ph·∫ßn m·ªÅm', 
                cutoff2024: 24.2, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 5, increase_025_05: 20, increase_05_075: 40, increase_075_1: 30, increase_over_1: 5}
            },
            {
                school: 'UIT',
                code: '7520207', 
                name: 'Thi·∫øt k·∫ø Vi m·∫°ch', 
                cutoff2024: 26.0, 
                subjects: ['A00', 'A01'], 
                minMath: 7.0,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 5, increase_025_05: 10, increase_05_075: 25, increase_075_1: 40, increase_over_1: 20}
            },
            {
                school: 'UIT',
                code: '7480103_CLC', 
                name: 'K·ªπ thu·∫≠t Ph·∫ßn m·ªÅm (Ch·∫•t l∆∞·ª£ng cao)', 
                cutoff2024: 25.8, 
                subjects: ['A00', 'A01', 'D07'], 
                minMath: 6.5,
                probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 10, increase_025_05: 20, increase_05_075: 40, increase_075_1: 25, increase_over_1: 5}
            }
        ];

        // D·ªÆ LI·ªÜU M·ªöI T·ª™ FILE CSV
        const hcmusMajors = [
             // D·ªØ li·ªáu c≈© ƒë∆∞·ª£c gi·ªØ l·∫°i
            { school: 'HCMUS', code: '7480105', name: 'Khoa h·ªçc m√°y t√≠nh (Ch∆∞∆°ng tr√¨nh Ti√™n ti·∫øn)', cutoff2024: 28.5, subjects: ['A00', 'A01', 'D07'], minMath: 7.0, probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 5, increase_025_05: 15, increase_05_075: 30, increase_075_1: 40, increase_over_1: 10} },
            { school: 'HCMUS', code: '7480207', name: 'Tr√≠ tu·ªá Nh√¢n t·∫°o', cutoff2024: 27.7, subjects: ['A00', 'A01', 'D07'], minMath: 6.5, probabilities: {decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 0, increase_025_05: 5, increase_05_075: 20, increase_075_1: 35, increase_over_1: 40} },
            // D·ªØ li·ªáu m·ªõi t·ª´ file
            { school: 'HCMUS', code: 'QHT01', name: 'Nh√≥m ng√†nh V·∫≠t l√Ω h·ªçc, C√¥ng ngh·ªá V·∫≠t l√Ω ƒëi·ªán t·ª≠ v√† tin h·ªçc', cutoff2024: 25.10, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 40, increase_05_075: 30, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT02', name: 'V·∫≠t l√Ω h·ªçc (CT tƒÉng c∆∞·ªùng ti·∫øng Anh)', cutoff2024: 23.00, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 40, increase_025_05: 30, increase_075_1: 0, increase_over_1: 0, increase_05_075: 10 } },
            { school: 'HCMUS', code: 'QHT03', name: 'H·∫£i d∆∞∆°ng h·ªçc', cutoff2024: 20.00, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 45, increase_0_025: 30, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT04', name: 'H√≥a h·ªçc', cutoff2024: 25.42, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT05', name: 'H√≥a h·ªçc (CT tƒÉng c∆∞·ªùng ti·∫øng Anh)', cutoff2024: 24.65, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 45, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT06', name: 'Khoa h·ªçc V·∫≠t li·ªáu', cutoff2024: 22.30, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT07', name: 'Sinh h·ªçc', cutoff2024: 23.00, subjects: ['B00', 'B08'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT08', name: 'C√¥ng ngh·ªá sinh h·ªçc', cutoff2024: 25.00, subjects: ['B00', 'B08', 'A00'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 30, increase_025_05: 40, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT09', name: 'Khoa h·ªçc M√¥i tr∆∞·ªùng', cutoff2024: 21.00, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 45, increase_0_025: 30, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT10', name: 'Khoa h·ªçc M√¥i tr∆∞·ªùng (CT tƒÉng c∆∞·ªùng ti·∫øng Anh)', cutoff2024: 20.00, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 20, decrease_0_025: 50, increase_0_025: 25, increase_025_05: 5, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT11', name: 'ƒê·ªãa ch·∫•t h·ªçc', cutoff2024: 18.00, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 25, decrease_0_025: 55, increase_0_025: 20, increase_025_05: 0, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT12', name: 'Nh√≥m ng√†nh To√°n - Th·ªëng k√™', cutoff2024: 25.75, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 40, increase_05_075: 30, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT13', name: 'To√°n h·ªçc (CT tƒÉng c∆∞·ªùng ti·∫øng Anh)', cutoff2024: 24.50, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 30, increase_025_05: 40, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT14', name: 'Nh√≥m ng√†nh C√¥ng ngh·ªá th√¥ng tin', cutoff2024: 27.00, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 0, increase_0_025: 10, increase_025_05: 25, increase_05_075: 40, increase_075_1: 20, increase_over_1: 5 } },
            { school: 'HCMUS', code: 'QHT15', name: 'Khoa h·ªçc D·ªØ li·ªáu (CT Ti√™n ti·∫øn)', cutoff2024: 26.75, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 35, increase_05_075: 30, increase_075_1: 15, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT16', name: 'K·ªπ thu·∫≠t ƒêi·ªán t·ª≠ - Vi·ªÖn th√¥ng', cutoff2024: 25.25, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 30, increase_025_05: 40, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT17', name: 'K·ªπ thu·∫≠t ƒêi·ªán t·ª≠ - Vi·ªÖn th√¥ng (CT tƒÉng c∆∞·ªùng ti·∫øng Anh)', cutoff2024: 24.50, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 40, increase_025_05: 30, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT18', name: 'C√¥ng ngh·ªá K·ªπ thu·∫≠t M√¥i tr∆∞·ªùng', cutoff2024: 20.50, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 45, increase_0_025: 30, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT19', name: 'Qu·∫£n l√Ω t√†i nguy√™n v√† m√¥i tr∆∞·ªùng', cutoff2024: 20.50, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 45, increase_0_025: 30, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT20', name: 'C√¥ng ngh·ªá v·∫≠t li·ªáu', cutoff2024: 23.50, subjects: ['A00', 'A01', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'HCMUS', code: 'QHT21', name: 'K·ªπ thu·∫≠t ƒë·ªãa ch·∫•t', cutoff2024: 17.00, subjects: ['A00', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 30, decrease_0_025: 50, increase_0_025: 20, increase_025_05: 0, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } }
        ];

        const spktMajors = [
            // D·ªØ li·ªáu c≈© ƒë∆∞·ª£c gi·ªØ l·∫°i v√† c·∫≠p nh·∫≠t
            { school: 'SPKT', code: '7140231', name: 'S∆∞ ph·∫°m Ti·∫øng Anh', cutoff2024: 27.5, subjects: ['D01', 'D96', 'D09'], minMath: 6.0, probabilities: {decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 30, increase_05_075: 35, increase_075_1: 10, increase_over_1: 0} },
            { school: 'SPKT', code: '7210403V', name: 'Thi·∫øt k·∫ø ƒë·ªì h·ªça (H·ªá ƒë·∫°i tr√†)', cutoff2024: 26.5, subjects: ['A00', 'D01', 'V00'], minMath: 5.5, probabilities: {decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 40, increase_025_05: 35, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0} },
            { school: 'SPKT', code: '7480201V', name: 'C√¥ng ngh·ªá th√¥ng tin (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.97, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 35, increase_05_075: 35, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480201A', name: 'C√¥ng ngh·ªá th√¥ng tin (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 25.65, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 40, increase_05_075: 30, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510303V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªÅu khi·ªÉn v√† t·ª± ƒë·ªông h√≥a (H·ªá ƒë·∫°i tr√†)', cutoff2024: 26.14, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 30, increase_05_075: 35, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510303A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªÅu khi·ªÉn v√† t·ª± ƒë·ªông h√≥a (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 25.35, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 30, increase_05_075: 35, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510205V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t √¥ t√¥ (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.39, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 35, increase_05_075: 35, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510205A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t √¥ t√¥ (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 24.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 35, increase_05_075: 35, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510201V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t c∆° kh√≠ (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.1, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510201A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t c∆° kh√≠ (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 24.25, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510301V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªán, ƒëi·ªán t·ª≠ (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.12, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510301A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªán, ƒëi·ªán t·ª≠ (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 24.5, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340405', name: 'Logistics v√† qu·∫£n l√Ω chu·ªói cung ·ª©ng', cutoff2024: 25.21, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 30, increase_05_075: 40, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340101V', name: 'Qu·∫£n tr·ªã kinh doanh (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340101A', name: 'Qu·∫£n tr·ªã kinh doanh (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 24.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 40, increase_025_05: 30, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7220201V', name: 'Ng√¥n ng·ªØ Anh (H·ªá ƒë·∫°i tr√†)', cutoff2024: 24.57, subjects: ['D01', 'D96', 'D09'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 25, increase_025_05: 40, increase_05_075: 25, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340301V', name: 'K·∫ø to√°n (H·ªá ƒë·∫°i tr√†)', cutoff2024: 22.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7540101V', name: 'C√¥ng ngh·ªá th·ª±c ph·∫©m (H·ªá ƒë·∫°i tr√†)', cutoff2024: 24.2, subjects: ['A00', 'A01', 'B00', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 25, increase_0_025: 40, increase_025_05: 25, increase_075_1: 0, increase_over_1: 0, increase_05_075: 0 } },
            { school: 'SPKT', code: '7540101A', name: 'C√¥ng ngh·ªá th·ª±c ph·∫©m (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 22.5, subjects: ['A00', 'A01', 'B00', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 25, increase_0_025: 40, increase_025_05: 25, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510203V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t c∆° ƒëi·ªán t·ª≠ (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.45, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510203A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t c∆° ƒëi·ªán t·ª≠ (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 25.1, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510102V', name: 'K·ªπ thu·∫≠t x√¢y d·ª±ng (C√¥ng ngh·ªá k·ªπ thu·∫≠t c√¥ng tr√¨nh x√¢y d·ª±ng)', cutoff2024: 23.05, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 45, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7210403A', name: 'Thi·∫øt k·∫ø ƒë·ªì h·ªça (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 25.5, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 30, increase_025_05: 40, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340122', name: 'Th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠', cutoff2024: 23.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 20, increase_025_05: 40, increase_05_075: 25, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510406V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t m√¥i tr∆∞·ªùng', cutoff2024: 22.0, subjects: ['A00', 'A01', 'B00', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 20, decrease_0_025: 50, increase_0_025: 25, increase_025_05: 5, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7520117', name: 'K·ªπ thu·∫≠t h·ªá th·ªëng c√¥ng nghi·ªáp', cutoff2024: 23.88, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 20, increase_0_025: 45, increase_025_05: 25, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510205N', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t √¥ t√¥ (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', cutoff2024: 25.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 35, increase_05_075: 35, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510601V', name: 'Qu·∫£n l√Ω c√¥ng nghi·ªáp (H·ªá ƒë·∫°i tr√†)', cutoff2024: 24.2, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7520212', name: 'K·ªπ thu·∫≠t y sinh (ƒêi·ªán t·ª≠ y sinh)', cutoff2024: 24.15, subjects: ['A00', 'A01', 'B00', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7580101V', name: 'Ki·∫øn tr√∫c', cutoff2024: 22.97, subjects: ['A00', 'A01', 'D01', 'V00'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_075_1: 0, increase_over_1: 0, increase_05_075: 0 } },
            { school: 'SPKT', code: '7580103', name: 'Ki·∫øn tr√∫c n·ªôi th·∫•t', cutoff2024: 22.77, subjects: ['A00', 'A01', 'D01', 'V00'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7580205V', name: 'K·ªπ thu·∫≠t x√¢y d·ª±ng c√¥ng tr√¨nh giao th√¥ng', cutoff2024: 21.55, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7580302V', name: 'Qu·∫£n l√Ω x√¢y d·ª±ng', cutoff2024: 22.17, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 40, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7810103V', name: 'Qu·∫£n tr·ªã nh√† h√†ng v√† d·ªãch v·ª• ƒÉn u·ªëng (H·ªá ƒë·∫°i tr√†)', cutoff2024: 23.27, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 25, increase_0_025: 45, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7840110', name: 'Qu·∫£n l√Ω v√† v·∫≠n h√†nh h·∫° t·∫ßng', cutoff2024: 21.22, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 45, increase_0_025: 30, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            // D·ªØ li·ªáu m·ªõi t·ª´ CSV
            { school: 'SPKT', code: '7140246V', name: 'S∆∞ ph·∫°m C√¥ng ngh·ªá', cutoff2024: 24.15, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 45, increase_025_05: 30, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7210404V', name: 'Thi·∫øt k·∫ø th·ªùi trang', cutoff2024: 24.8, subjects: ['A00', 'D01', 'V00'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 40, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7310403V', name: 'T√¢m l√Ω h·ªçc gi√°o d·ª•c', cutoff2024: 25.15, subjects: ['A00', 'D01', 'C00'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 40, increase_025_05: 35, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7340120V', name: 'Kinh doanh Qu·ªëc t·∫ø', cutoff2024: 22.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7380101V', name: 'Lu·∫≠t', cutoff2024: 25.12, subjects: ['A00', 'D01', 'C00'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 30, increase_025_05: 40, increase_05_075: 15, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480108A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t m√°y t√≠nh (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 25.4, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480108V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t m√°y t√≠nh (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.5, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 10, increase_0_025: 25, increase_025_05: 40, increase_05_075: 20, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480118V', name: 'H·ªá th·ªëng nh√∫ng v√† IoT', cutoff2024: 25.65, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 35, increase_05_075: 35, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480201N', name: 'C√¥ng ngh·ªá th√¥ng tin (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', cutoff2024: 25.65, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 40, increase_05_075: 30, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480202V', name: 'An to√†n th√¥ng tin', cutoff2024: 24.89, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 20, increase_025_05: 40, increase_05_075: 30, increase_075_1: 5, increase_over_1: 0 } },
            { school: 'SPKT', code: '7480203V', name: 'K·ªπ thu·∫≠t d·ªØ li·ªáu', cutoff2024: 24.05, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 35, increase_05_075: 35, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510102A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t c√¥ng tr√¨nh x√¢y d·ª±ng (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 21.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7210104', name: 'H·ªá th·ªëng k·ªπ thu·∫≠t c√¥ng tr√¨nh x√¢y d·ª±ng', cutoff2024: 22.22, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 45, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510202A', name: 'C√¥ng ngh·ªá ch·∫ø t·∫°o m√°y (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 23.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 45, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510202N', name: 'C√¥ng ngh·ªá ch·∫ø t·∫°o m√°y (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', cutoff2024: 23.75, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 45, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510202V', name: 'C√¥ng ngh·ªá ch·∫ø t·∫°o m√°y (H·ªá ƒë·∫°i tr√†)', cutoff2024: 24.27, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 45, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510206A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t nhi·ªát (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 21.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510206N', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t nhi·ªát (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', cutoff2024: 24.4, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 40, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510206V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t nhi·ªát (H·ªá ƒë·∫°i tr√†)', cutoff2024: 24.4, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 40, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510208V', name: 'NƒÉng l∆∞·ª£ng t√°i t·∫°o', cutoff2024: 23.15, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 30, increase_0_025: 40, increase_025_05: 20, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510209V', name: 'Robot v√† tr√≠ tu·ªá nh√¢n t·∫°o', cutoff2024: 25.66, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 30, increase_05_075: 40, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510302A', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªán t·ª≠, vi·ªÖn th√¥ng (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 24.35, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510302N', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªán t·ª≠, vi·ªÖn th√¥ng (Ch∆∞∆°ng tr√¨nh Vi·ªát-Nh·∫≠t)', cutoff2024: 24.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7520208V', name: 'K·ªπ thu·∫≠t Thi·∫øt k·∫ø Vi m·∫°ch', cutoff2024: 25.95, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 0, decrease_0_025: 5, increase_0_025: 15, increase_025_05: 30, increase_05_075: 35, increase_075_1: 10, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510302V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t ƒëi·ªán t·ª≠, vi·ªÖn th√¥ng (H·ªá ƒë·∫°i tr√†)', cutoff2024: 25.15, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510401V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t h√≥a h·ªçc', cutoff2024: 24.9, subjects: ['A00', 'A01', 'B00', 'D07'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 20, increase_0_025: 40, increase_025_05: 30, increase_05_075: 5, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510402V', name: 'C√¥ng ngh·ªá v·∫≠t li·ªáu', cutoff2024: 23.33, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 10, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 15, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510601A', name: 'Qu·∫£n l√Ω c√¥ng nghi·ªáp (Ch·∫•t l∆∞·ª£ng cao ti·∫øng Anh)', cutoff2024: 23.05, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 5, decrease_0_025: 15, increase_0_025: 30, increase_025_05: 40, increase_05_075: 10, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7510801V', name: 'C√¥ng ngh·ªá k·ªπ thu·∫≠t in', cutoff2024: 22.0, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: { decrease_over_025: 20, decrease_0_025: 50, increase_0_025: 25, increase_025_05: 5, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7540209V', name: 'C√¥ng ngh·ªá may', cutoff2024: 21.41, subjects: ['A00', 'A01', 'D01'], minMath: 5.0, probabilities: { decrease_over_025: 15, decrease_0_025: 40, increase_0_025: 35, increase_025_05: 10, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } },
            { school: 'SPKT', code: '7540210', name: 'K·ªπ ngh·ªá g·ªó v√† n·ªôi th·∫•t', cutoff2024: 20.5, subjects: ['A00', 'A01', 'D01', 'V00'], minMath: 5.0, probabilities: { decrease_over_025: 25, decrease_0_025: 55, increase_0_025: 20, increase_025_05: 0, increase_05_075: 0, increase_075_1: 0, increase_over_1: 0 } }
        ];

        const fptMajors = [
            // D·ªØ li·ªáu c≈© ƒë∆∞·ª£c gi·ªØ l·∫°i
            { school: 'FPT', code: '7480201', name: 'C√¥ng ngh·ªá th√¥ng tin', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D07'], minMath: 5.0, probabilities: null },
            // D·ªØ li·ªáu m·ªõi t·ª´ file
            { school: 'FPT', code: 'FPT01', name: 'K·ªπ thu·∫≠t ph·∫ßn m·ªÅm', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT02', name: 'An to√†n th√¥ng tin', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT03', name: 'Tr√≠ tu·ªá nh√¢n t·∫°o', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT04', name: 'Thi·∫øt k·∫ø M·ªπ thu·∫≠t s·ªë', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT05', name: 'Qu·∫£n tr·ªã kinh doanh', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT06', name: 'Kinh doanh qu·ªëc t·∫ø', cutoff2024: 21.00, subjects: ['A00', 'A01', 'D01', 'D90'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT07', name: 'Ng√¥n ng·ªØ Anh', cutoff2024: 21.00, subjects: ['A01', 'D01', 'D96'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT08', name: 'Ng√¥n ng·ªØ Nh·∫≠t', cutoff2024: 21.00, subjects: ['A01', 'D01', 'D96'], minMath: 5.0, probabilities: null },
            { school: 'FPT', code: 'FPT09', name: 'Ng√¥n ng·ªØ H√†n Qu·ªëc', cutoff2024: 21.00, subjects: ['A01', 'D01', 'D96'], minMath: 5.0, probabilities: null }
        ];

        // K·∫øt h·ª£p t·∫•t c·∫£ ng√†nh
        const allMajors = [...uitMajors, ...hcmusMajors, ...spktMajors, ...fptMajors];

        // T·ªï h·ª£p x√©t tuy·ªÉn
        const combinations = {
            'A00': ['toan', 'ly', 'hoa'],     
            'A01': ['toan', 'ly', 'anh'],    
            'A02': ['toan', 'hoa', 'sinh'],
            'B00': ['toan', 'hoa', 'sinh'],
            'B03': ['toan', 'sinh', 'hoa'],
            'B08': ['toan', 'sinh', 'hoa'],
            'C00': ['van', 'su', 'dia'],
            'D01': ['toan', 'van', 'anh'],   
            'D07': ['toan', 'hoa', 'anh'],
            'D90': ['toan', 'anh', 'ly'], // Gi·∫£ ƒë·ªãnh cho SPKT
            'D96': ['toan', 'anh', 'su'], // Gi·∫£ ƒë·ªãnh cho FPT
            'V00': ['van', 'ly', 'anh']
        };

        let wishList = [];
        let cutoff2025Generated = {};
        let admissionProcessed = false;
        let paymentCompleted = false;
        let currentUserName = 'NGUY·ªÑN VƒÇN A';
        let draggedIndex = null;
        
        // ƒêi·ªÉm ∆∞u ti√™n c√°c khu v·ª±c theo quy ƒë·ªãnh ch√≠nh th·ª©c
        const areaBonus = {
            'KV1': 0.75,    
            'KV2NT': 0.5,   
            'KV2': 0.25,    
            'KV3': 0        
        };

        // Kh·ªüi t·∫°o
        document.addEventListener('DOMContentLoaded', function() {
            updateWishStats();
            updateAreaInfo();
            populateAiWishSelectors();
            console.log('üéì H·ªá th·ªëng ho√†n ch·ªânh - ' + allMajors.length + ' ng√†nh t·ª´ 4 tr∆∞·ªùng!');
        });

        // Th√¥ng b√°o h√†i h∆∞·ªõc cho n√∫t trang tr√≠
        function showDecorativeAlert() {
            showToast('N√∫t ƒë·ªÉ trang tr√≠, Kh√¥ng b·∫•m ƒë∆∞·ª£c nha ü§£');
        }

        // Hi·ªÉn th·ªã toast notification
        function showToast(message) {
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.add('fade-out');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        // Hi·ªÉn th·ªã modal h∆∞·ªõng d·∫´n
        function showGuide() {
            document.getElementById('guideModal').style.display = 'block';
        }

        function closeGuideModal() {
            document.getElementById('guideModal').style.display = 'none';
        }

        // Ch·ª©c nƒÉng ch·ªânh s·ª≠a th√¥ng tin c√° nh√¢n
        function editInfo(valueId, editId) {
            const valueElement = document.getElementById(valueId);
            const editElement = document.getElementById(editId);
            const editControls = editElement.parentNode.querySelector('.edit-controls');
            const editBtn = editElement.parentNode.querySelector('.edit-btn');
            
            valueElement.style.display = 'none';
            editElement.style.display = 'flex';
            editControls.style.display = 'flex';
            editBtn.style.display = 'none';
            editElement.focus();
        }

        function saveInfo(valueId, editId) {
            const valueElement = document.getElementById(valueId);
            const editElement = document.getElementById(editId);
            const newValue = editElement.value.trim();
            
            if (newValue !== '') {
                valueElement.textContent = newValue;
                
                if (valueId === 'userNameInfo') {
                    currentUserName = newValue;
                    document.getElementById('userName').textContent = newValue;
                }
                
                cancelEdit(valueId, editId);
            } else {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p th√¥ng tin h·ª£p l·ªá!');
            }
        }

        function cancelEdit(valueId, editId) {
            const valueElement = document.getElementById(valueId);
            const editElement = document.getElementById(editId);
            const editControls = editElement.parentNode.querySelector('.edit-controls');
            const editBtn = editElement.parentNode.querySelector('.edit-btn');
            
            valueElement.style.display = 'inline';
            editElement.style.display = 'none';
            editControls.style.display = 'none';
            editBtn.style.display = 'inline-block';
        }

        // Ch·ª©c nƒÉng s·ª≠a t√™n
        function editName() {
            document.getElementById('editNameInput').value = currentUserName;
            document.getElementById('editNameInput').style.display = 'flex';
            document.getElementById('editNameButtons').style.display = 'flex';
            document.getElementById('editNameBtn').style.display = 'none';
            document.getElementById('editNameInput').focus();
        }

        function saveNewName() {
            const newName = document.getElementById('editNameInput').value.trim();
            if (newName && newName !== '') {
                currentUserName = newName;
                document.getElementById('userName').textContent = newName;
                document.getElementById('userNameInfo').textContent = newName;
                cancelEditName();
                showToast(`‚úÖ T√™n ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t th√†nh: ${newName}`);
            } else {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p t√™n h·ª£p l·ªá!');
            }
        }

        function cancelEditName() {
            document.getElementById('editNameInput').style.display = 'none';
            document.getElementById('editNameButtons').style.display = 'none';
            document.getElementById('editNameBtn').style.display = 'inline-block';
        }

        // C·∫≠p nh·∫≠t th√¥ng tin khu v·ª±c
        function updateAreaInfo() {
            const areaSelect = document.getElementById('areaSelect');
            const currentBonusInfo = document.getElementById('currentBonusInfo');
            const selectedArea = areaSelect.value;
            const bonus = areaBonus[selectedArea];
            
            if (bonus > 0) {
                currentBonusInfo.textContent = `+${bonus} ƒëi·ªÉm (gi·∫£m d·∫ßn n·∫øu t·ªïng ƒëi·ªÉm ‚â•22.5)`;
            } else {
                currentBonusInfo.textContent = `${bonus} ƒëi·ªÉm (kh√¥ng ƒë∆∞·ª£c ∆∞u ti√™n)`;
            }
        }

        // C·∫≠p nh·∫≠t dropdown ng√†nh theo tr∆∞·ªùng
        function updateMajorSelect() {
            const schoolSelect = document.getElementById('schoolSelect');
            const majorSelect = document.getElementById('majorSelect');
            
            majorSelect.innerHTML = '<option value="">-- Ch·ªçn ng√†nh --</option>';
            
            if (schoolSelect.value) {
                majorSelect.disabled = false;
                const schoolMajors = allMajors.filter(m => m.school === schoolSelect.value);
                schoolMajors.forEach(major => {
                    const option = document.createElement('option');
                    option.value = major.school + '_' + major.code;
                    option.textContent = `${major.name} (${major.code})`;
                    majorSelect.appendChild(option);
                });
            } else {
                majorSelect.disabled = true;
            }
            checkGeminiButtons();
        }

        // C·∫≠p nh·∫≠t inputs m√¥n h·ªçc
        function updateSubjectInputs() {
            const subject1 = document.getElementById('subject1').value;
            const subject2 = document.getElementById('subject2').value;
            const score1Input = document.getElementById('score1');
            const score2Input = document.getElementById('score2');
            
            score1Input.disabled = !subject1;
            score2Input.disabled = !subject2;
            
            if (!subject1) score1Input.value = '';
            if (!subject2) score2Input.value = '';
            
            if (subject1 && subject2 && subject1 === subject2) {
                alert('‚ö†Ô∏è Hai m√¥n t·ª± ch·ªçn kh√¥ng ƒë∆∞·ª£c tr√πng nhau!');
                document.getElementById('subject2').value = '';
                score2Input.disabled = true;
                score2Input.value = '';
            }
            checkGeminiButtons();
        }

        // Hi·ªÉn th·ªã ƒëi·ªÉm chu·∫©n 2024 theo tr∆∞·ªùng
        function showCutoff2024(school) {
            const modal = document.getElementById('cutoff2024Modal');
            const title = document.getElementById('cutoffModalTitle');
            const tableBody = document.getElementById('cutoff2024TableBody');
            
            let schoolName = '';
            let schoolData = [];
            
            switch(school) {
                case 'UIT':
                    schoolName = 'UIT';
                    schoolData = uitMajors;
                    break;
                case 'HCMUS':
                    schoolName = 'HCMUS';  
                    schoolData = hcmusMajors;
                    break;
                case 'SPKT':
                    schoolName = 'SPKT';
                    schoolData = spktMajors;
                    break;
                case 'FPT':
                    schoolName = 'FPT';
                    schoolData = fptMajors;
                    break;
            }
            
            title.textContent = `üìä B·∫¢NG ƒêI·ªÇM CHU·∫®N ${schoolName} NƒÇM 2024`;
            
            let html = '';
            schoolData.sort((a, b) => b.cutoff2024 - a.cutoff2024).forEach((major, index) => {
                html += `
                    <tr>
                        <td data-label="STT">${index + 1}</td>
                        <td data-label="M√£ ng√†nh">${major.code}</td>
                        <td data-label="T√™n ng√†nh">${major.name}</td>
                        <td data-label="T·ªï h·ª£p">${major.subjects.join(', ')}</td>
                        <td data-label="ƒêi·ªÅu ki·ªán To√°n">‚â• ${major.minMath}</td>
                        <td data-label="ƒêi·ªÉm chu·∫©n 2024" style="font-weight: bold; color: #337ab7;">${major.cutoff2024.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            modal.style.display = 'block';
        }

        function closeCutoff2024Modal() {
            document.getElementById('cutoff2024Modal').style.display = 'none';
        }

        // Th√™m nguy·ªán v·ªçng
        function addWish() {
            const schoolSelect = document.getElementById('schoolSelect');
            const majorSelect = document.getElementById('majorSelect');
            const majorKey = majorSelect.value;
            
            if (!schoolSelect.value || !majorKey) {
                alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn tr∆∞·ªùng v√† ng√†nh ƒë·ªÉ th√™m!');
                return;
            }

            if (wishList.some(wish => (wish.school + '_' + wish.code) === majorKey)) {
                alert('‚ö†Ô∏è Ng√†nh n√†y ƒë√£ c√≥ trong danh s√°ch nguy·ªán v·ªçng!');
                return;
            }

            const [school, code] = majorKey.split('_');
            const major = allMajors.find(m => m.school === school && m.code === code);
            
            if (major) {
                wishList.push({
                    ...major, 
                    wishOrder: wishList.length + 1
                });
                renderWishList();
                updateWishStats();
                updatePaymentInfo();
                majorSelect.value = '';
                checkGeminiButtons();
            }
        }

        // Hi·ªÉn th·ªã danh s√°ch nguy·ªán v·ªçng v·ªõi drag & drop ƒë√£ s·ª≠a
        function renderWishList() {
            const container = document.getElementById('wishContainer');
            
            if (wishList.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 15px;">
                        <p>üéØ <strong>Ch∆∞a c√≥ nguy·ªán v·ªçng n√†o</strong></p>
                        <p style="font-size: 9px;">Ch·ªçn tr∆∞·ªùng v√† ng√†nh, nh·∫•n "Th√™m" ƒë·ªÉ b·∫Øt ƒë·∫ßu!</p>
                    </div>
                `;
                return;
            }

            let html = '';
            wishList.forEach((wish, index) => {
                html += `
                    <div class="wish-item" draggable="true" 
                         onmousedown="startDrag(event, ${index})"
                         ondragstart="handleDragStart(event, ${index})" 
                         ondragover="handleDragOver(event)" 
                         ondrop="handleDrop(event, ${index})"
                         ondragend="handleDragEnd(event)">
                        <div class="drag-handle" title="K√©o ƒë·ªÉ ƒë·ªïi v·ªã tr√≠">‚ãÆ‚ãÆ</div>
                        <div class="wish-number">${index + 1}</div>
                        <div class="wish-content">
                            <div class="wish-name">${wish.school} - ${wish.name}</div>
                            <div class="wish-details">
                                üìä ${wish.code} | üéØ ${wish.subjects.join(', ')} | üìê To√°n ‚â• ${wish.minMath} | 
                                üìà DC 2024: ${wish.cutoff2024.toFixed(2)}
                            </div>
                        </div>
                        <button class="remove-wish" onclick="removeWish(${index})" title="X√≥a">‚úï</button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Drag & Drop handlers ƒë√£ s·ª≠a l·ªói
        function startDrag(e, index) {
            draggedIndex = index;
        }

        function handleDragStart(e, index) {
            draggedIndex = index;
            e.currentTarget.classList.add('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            const dropTarget = e.currentTarget;
            
            document.querySelectorAll('.wish-item').forEach(item => {
                item.classList.remove('drag-over');
            });
            
            if (dropTarget && dropTarget.classList.contains('wish-item')) {
                dropTarget.classList.add('drag-over');
            }
        }

        function handleDrop(e, dropIndex) {
            e.preventDefault();
            
            if (draggedIndex !== null && draggedIndex !== dropIndex) {
                const draggedItem = wishList[draggedIndex];
                wishList.splice(draggedIndex, 1);
                wishList.splice(dropIndex, 0, draggedItem);
                
                wishList.forEach((wish, i) => {
                    wish.wishOrder = i + 1;
                });
                
                renderWishList();
                updateWishStats();
            }
        }

        function handleDragEnd(e) {
            document.querySelectorAll('.wish-item').forEach(item => {
                item.classList.remove('dragging', 'drag-over');
            });
            
            draggedIndex = null;
        }

        // X√≥a nguy·ªán v·ªçng
        function removeWish(index) {
            if (confirm('üóëÔ∏è X√≥a nguy·ªán v·ªçng n√†y?')) {
                wishList.splice(index, 1);
                wishList.forEach((wish, i) => {
                    wish.wishOrder = i + 1;
                });
                renderWishList();
                updateWishStats();
                updatePaymentInfo();
                checkGeminiButtons();
            }
        }

        // X√≥a t·∫•t c·∫£
        function clearAllWishes() {
            if (wishList.length === 0) return;
            
            if (confirm('üóëÔ∏è X√≥a t·∫•t c·∫£ nguy·ªán v·ªçng?')) {
                wishList = [];
                renderWishList();
                updateWishStats();
                updatePaymentInfo();
                paymentCompleted = false;
                document.getElementById('submitBtn').disabled = true;
                checkGeminiButtons();
            }
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateWishStats() {
            document.getElementById('totalWishes').textContent = wishList.length;
        }

        // C·∫≠p nh·∫≠t th√¥ng tin thanh to√°n
        function updatePaymentInfo() {
            const paymentSection = document.getElementById('paymentSection');
            const paymentWishCount = document.getElementById('paymentWishCount');
            const paymentTotal = document.getElementById('paymentTotal');
            
            if (wishList.length > 0) {
                paymentSection.style.display = 'block';
                paymentWishCount.textContent = wishList.length;
                const total = wishList.length * 15000;
                paymentTotal.textContent = total.toLocaleString('vi-VN') + ' VNƒê';
                
                if (!paymentCompleted) {
                    document.getElementById('submitBtn').disabled = true;
                }
            } else {
                paymentSection.style.display = 'none';
                paymentCompleted = false;
                document.getElementById('submitBtn').disabled = true;
            }
        }

        // X·ª≠ l√Ω thanh to√°n gi·∫£ l·∫≠p
        function processPayment() {
            if (wishList.length === 0) {
                alert('‚ö†Ô∏è Kh√¥ng c√≥ nguy·ªán v·ªçng n√†o ƒë·ªÉ thanh to√°n!');
                return;
            }
            
            const total = wishList.length * 15000;
            const confirmMsg = `üí∞ Thanh to√°n ${total.toLocaleString('vi-VN')} VNƒê cho ${wishList.length} nguy·ªán v·ªçng?\n(ƒê√¢y l√† thanh to√°n gi·∫£ l·∫≠p, kh√¥ng thu ti·ªÅn th·∫≠t)`;
            
            if (confirm(confirmMsg)) {
                setTimeout(() => {
                    paymentCompleted = true;
                    document.getElementById('submitBtn').disabled = false;
                    document.querySelector('.payment-section').style.background = '#dff0d8';
                    document.querySelector('.payment-section h5').innerHTML = '‚úÖ THANH TO√ÅN TH√ÄNH C√îNG';
                    showToast('‚úÖ Thanh to√°n th√†nh c√¥ng! C√≥ th·ªÉ x√©t tuy·ªÉn.');
                }, 1500);
            }
        }

        // Random ƒëi·ªÉm chu·∫©n 2025
        function generateCutoff2025() {
            cutoff2025Generated = {};

            allMajors.forEach(major => {
                const cutoffKey = major.school + '_' + major.code;
                
                // FPT kh√¥ng random, gi·ªØ nguy√™n ƒëi·ªÉm 2024
                if (major.school === 'FPT' || !major.probabilities) {
                    cutoff2025Generated[cutoffKey] = major.cutoff2024;
                    return;
                }
                
                // C√°c tr∆∞·ªùng kh√°c random theo x√°c su·∫•t
                const prob = major.probabilities;
                const rand = Math.random() * 100;
                let change = 0;
                let cumulative = 0;
                
                cumulative += prob.decrease_over_025;
                if (rand < cumulative) {
                    change = -0.25 - Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                cumulative += prob.decrease_0_025;
                if (rand < cumulative) {
                    change = -Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                cumulative += prob.increase_0_025;
                if (rand < cumulative) {
                    change = Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                cumulative += prob.increase_025_05;
                if (rand < cumulative) {
                    change = 0.25 + Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                cumulative += prob.increase_05_075;
                if (rand < cumulative) {
                    change = 0.5 + Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                cumulative += prob.increase_075_1;
                if (rand < cumulative) {
                    change = 0.75 + Math.random() * 0.25;
                    cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
                    return;
                }
                
                // TƒÉng > 1.0 (t·ªëi ƒëa 1.5)
                change = 1.0 + Math.random() * 0.5;
                cutoff2025Generated[cutoffKey] = Math.max(15, Math.round((major.cutoff2024 + change) * 100) / 100);
            });

            return cutoff2025Generated;
        }

        // T√≠nh ƒëi·ªÉm ∆∞u ti√™n theo c√¥ng th·ª©c
        function calculateAreaBonus(totalScore) {
            const selectedArea = document.getElementById('areaSelect').value;
            const baseBonus = areaBonus[selectedArea];
            
            if (baseBonus === 0 || totalScore < 22.5) {
                return baseBonus;
            }
            
            const bonus = ((30 - totalScore) / 7.5) * baseBonus;
            return Math.max(0, Math.round(bonus * 1000) / 1000);
        }

        // X·ª≠ l√Ω x√©t tuy·ªÉn ho√†n ch·ªânh - ƒê√É TH√äM HI·ªÜU ·ª®NG LOADING
        function processAdmissionComplete() {
            if (!paymentCompleted) {
                alert('‚ö†Ô∏è Vui l√≤ng thanh to√°n tr∆∞·ªõc khi x√©t tuy·ªÉn!');
                return;
            }
            
            if (!validateForm()) {
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            const loadingContainer = document.getElementById('processLoadingContainer');

            // B·∫Øt ƒë·∫ßu loading
            submitBtn.disabled = true;
            submitBtnText.style.display = 'none';
            loadingContainer.style.display = 'inline-flex';
            
            setTimeout(() => {
                // K·∫øt th√∫c loading
                submitBtnText.style.display = 'inline-block';
                loadingContainer.style.display = 'none';
                
                const cutoff2025 = generateCutoff2025();
                const scores = getScores();
                const result = performAdmissionComplete(scores, wishList, cutoff2025);
                
                showAdmissionResultComplete(result, scores, cutoff2025);
                admissionProcessed = true;
                
                // Reset tr·∫°ng th√°i thanh to√°n
                paymentCompleted = false;
                document.querySelector('.payment-section').style.background = '#fff3cd';
                document.querySelector('.payment-section h5').innerHTML = 'üí≥ THANH TO√ÅN NGUY·ªÜN V·ªåNG (GI·∫¢ L·∫¨P)';
                
            }, 3000); // Ch·ªù 3 gi√¢y
        }

        // Validation
        function validateForm() {
            if (!document.getElementById('toan').value || 
                !document.getElementById('van').value) {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß ƒëi·ªÉm 2 m√¥n b·∫Øt bu·ªôc!');
                return false;
            }
            
            if (!document.getElementById('subject1').value || 
                !document.getElementById('score1').value ||
                !document.getElementById('subject2').value || 
                !document.getElementById('score2').value) {
                alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn v√† nh·∫≠p ƒëi·ªÉm 2 m√¥n t·ª± ch·ªçn!');
                return false;
            }
            
            if (wishList.length === 0) {
                alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt nguy·ªán v·ªçng!');
                return false;
            }
            
            return true;
        }

        // L·∫•y ƒëi·ªÉm t·ª´ form
        function getScores() {
            const subject1 = document.getElementById('subject1').value;
            const subject2 = document.getElementById('subject2').value;
            
            const baseScores = {
                'toan': parseFloat(document.getElementById('toan').value) || 0,
                'van': parseFloat(document.getElementById('van').value) || 0
            };
            
            baseScores[subject1] = parseFloat(document.getElementById('score1').value) || 0;
            baseScores[subject2] = parseFloat(document.getElementById('score2').value) || 0;
            
            return baseScores;
        }

        // T√≠nh ƒëi·ªÉm theo t·ªï h·ª£p
        function calculateScore(combination, scores) {
            const subjectCodes = combinations[combination];
            if (!subjectCodes) return { score: 0, areaBonus: 0, valid: false };
            
            let total = 0;
            for (let subject of subjectCodes) {
                if (scores[subject] !== undefined && scores[subject] !== null) {
                    total += parseFloat(scores[subject]);
                } else {
                    return { score: 0, areaBonus: 0, valid: false }; // Kh√¥ng ƒë·ªß m√¥n
                }
            }
            
            const areaBonusValue = calculateAreaBonus(total);
            total += areaBonusValue;
            
            return { score: total, areaBonus: areaBonusValue, valid: true };
        }

        // X√©t tuy·ªÉn ho√†n ch·ªânh
        function performAdmissionComplete(scores, wishes, cutoff2025) {
            let result = {
                admitted: false,
                admittedMajor: null,
                admittedWishOrder: 0,
                bestScore: 0,
                bestCombination: '',
                areaBonus: 0,
                allResults: []
            };
            
            for (let i = 0; i < wishes.length; i++) {
                const wish = wishes[i];
                let bestScoreForWish = 0;
                let bestCombForWish = '';
                let bestAreaBonus = 0;
                let isValidCombination = false;
                
                for (let combination of wish.subjects) {
                    const scoreResult = calculateScore(combination, scores);
                    if (scoreResult.valid && scoreResult.score > bestScoreForWish) {
                        bestScoreForWish = scoreResult.score;
                        bestCombForWish = combination;
                        bestAreaBonus = scoreResult.areaBonus;
                        isValidCombination = true;
                    }
                }
                
                const mathOK = scores.toan >= wish.minMath;
                const cutoffKey = wish.school + '_' + wish.code;
                const cutoff2025Value = cutoff2025[cutoffKey];
                const passedCutoff = bestScoreForWish >= cutoff2025Value;
                const passed = isValidCombination && mathOK && passedCutoff;
                
                const wishResult = {
                    major: wish,
                    bestScore: bestScoreForWish,
                    bestCombination: bestCombForWish,
                    areaBonus: bestAreaBonus,
                    mathOK: mathOK,
                    passedCutoff: passedCutoff,
                    passed: passed,
                    cutoff2025: cutoff2025Value,
                    difference: bestScoreForWish - cutoff2025Value,
                    isValidCombination: isValidCombination
                };
                
                result.allResults.push(wishResult);
                
                if (passed) {
                    result.admitted = true;
                    result.admittedMajor = wish;
                    result.admittedWishOrder = wish.wishOrder;
                    result.bestScore = bestScoreForWish;
                    result.bestCombination = bestCombForWish;
                    result.areaBonus = bestAreaBonus;
                    break; // D·ª´ng l·∫°i khi ƒë√£ tr√∫ng tuy·ªÉn 1 nguy·ªán v·ªçng
                }
            }
            
            return result;
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£ x√©t tuy·ªÉn v·ªõi SO S√ÅNH ƒêI·ªÇM chi ti·∫øt
        function showAdmissionResultComplete(result, scores, cutoff2025) {
            const modal = document.getElementById('resultModal');
            const modalBody = document.getElementById('modalBody');
            
            let html = '';
            
            if (result.admitted) {
                html += `
                    <div class="celebration">üéâ</div>
                    <div class="admission-certificate">
                        <div class="university-logo">${result.admittedMajor.school}</div>
                        <h3 style="color: #337ab7; margin-bottom: 10px;">
                            GI·∫§Y B√ÅO TR√öNG TUY·ªÇN (M√î PH·ªéNG)
                        </h3>
                        <p style="font-size: 12px; margin-bottom: 15px;">
                            <strong>${getSchoolFullName(result.admittedMajor.school)}</strong>
                        </p>
                        
                        <div style="background: white; padding: 12px; border-radius: 5px; margin: 15px 0; border: 1px solid #d6e9c6;">
                            <div style="text-align: left; font-size: 11px;">
                                <p><strong>üë§ Th√≠ sinh:</strong> ${currentUserName}</p>
                                <p><strong>üéØ Nguy·ªán v·ªçng tr√∫ng tuy·ªÉn:</strong> ${result.admittedWishOrder}</p>
                                <p><strong>üè´ Tr∆∞·ªùng:</strong> ${result.admittedMajor.school}</p>
                                <p><strong>üìö Ng√†nh h·ªçc:</strong> ${result.admittedMajor.name}</p>
                                <p><strong>üî¢ M√£ ng√†nh:</strong> ${result.admittedMajor.code}</p>
                                <p><strong>üìä T·ªï h·ª£p x√©t tuy·ªÉn:</strong> ${result.bestCombination}</p>
                                <p><strong>üéØ T·ªïng ƒëi·ªÉm x√©t tuy·ªÉn:</strong> ${result.bestScore.toFixed(3)} ƒëi·ªÉm</p>
                                <p><strong>üìà ƒêi·ªÉm chu·∫©n 2025:</strong> ${result.allResults[result.admittedWishOrder-1].cutoff2025.toFixed(2)} ƒëi·ªÉm</p>
                                <p><strong>üèòÔ∏è Khu v·ª±c:</strong> ${document.getElementById('areaSelect').value}</p>
                                <p><strong>‚ûï ƒêi·ªÉm ∆∞u ti√™n:</strong> ${result.areaBonus.toFixed(3)} ƒëi·ªÉm</p>
                            </div>
                            <div style="text-align: center; margin-top: 10px; padding: 8px; background: #dff0d8; border-radius: 3px;">
                                <strong style="color: #5cb85c; font-size: 12px;">
                                    üéä CH√öC M·ª™NG! B·∫†N ƒê√É TR√öNG TUY·ªÇN! üéä
                                </strong>
                            </div>
                        </div>
                    </div>
                `;
                
                setTimeout(() => createConfetti(), 1000);
                
            } else {
                html += `
                    <div style="text-align: center; font-size: 28px; color: #f0ad4e; margin: 10px 0;">üòî</div>
                    <div class="result-fail">
                        <h3 style="margin-bottom: 10px; font-size: 14px;">‚ùå R·∫§T TI·∫æC!</h3>
                        <p style="font-size: 11px;">ƒêi·ªÉm s·ªë ch∆∞a ƒë·∫°t ƒëi·ªÉm chu·∫©n c·ªßa c√°c nguy·ªán v·ªçng.</p>
                    </div>
                `;
            }
            
            // Chi ti·∫øt SO S√ÅNH ƒêI·ªÇM t·ª´ng nguy·ªán v·ªçng
            html += `
                <div style="margin-top: 15px;">
                    <h4 style="background: #f8f9fa; padding: 6px; border-left: 4px solid #337ab7; font-size: 12px;">
                        üìä SO S√ÅNH ƒêI·ªÇM ${wishList.length} NGUY·ªÜN V·ªåNG
                    </h4>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>NV</th>
                                <th>Tr∆∞·ªùng</th>
                                <th>Ng√†nh</th>
                                <th>T·ªï h·ª£p</th>
                                <th>ƒêi·ªÉm c·ªßa b·∫°n</th>
                                <th>DC 2025</th>
                                <th>ƒêi·ªÅu ki·ªán</th>
                                <th>K·∫øt qu·∫£</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            result.allResults.forEach((wishResult, index) => {
                let statusText, statusColor, reason;
                if (!wishResult.isValidCombination) {
                    statusText = '‚ùå Kh√¥ng ƒë·ªß m√¥n';
                    statusColor = '#d9534f';
                    reason = 'Kh√¥ng ƒë·ªß m√¥n cho t·ªï h·ª£p';
                } else if (!wishResult.mathOK) {
                    statusText = '‚ùå Kh√¥ng ƒë·∫°t';
                    statusColor = '#d9534f';
                    reason = `To√°n < ${wishResult.major.minMath}`;
                } else if (!wishResult.passedCutoff) {
                    statusText = '‚ùå Kh√¥ng ƒë·∫°t';
                    statusColor = '#d9534f';
                    reason = `Th·∫•p h∆°n DC (${wishResult.difference.toFixed(2)})`;
                } else {
                    statusText = '‚úÖ Tr√∫ng tuy·ªÉn';
                    statusColor = '#5cb85c';
                    reason = `Cao h∆°n DC (+${wishResult.difference.toFixed(2)})`;
                }

                // N·∫øu ƒë√£ tr√∫ng tuy·ªÉn ·ªü NV tr∆∞·ªõc, c√°c NV sau s·∫Ω kh√¥ng x√©t
                if (result.admitted && wishResult.major.wishOrder > result.admittedWishOrder) {
                    statusText = '‚ûñ Kh√¥ng x√©t';
                    statusColor = '#666';
                    reason = 'ƒê√£ tr√∫ng tuy·ªÉn NV tr∆∞·ªõc';
                }

                const bgColor = wishResult.passed && result.admitted && 
                              result.admittedMajor.code === wishResult.major.code ? 
                              '#dff0d8' : (index % 2 === 0 ? '#f9f9f9' : 'white');
                
                html += `
                    <tr>
                        <td data-label="NV" style="font-weight: bold;">
                            ${wishResult.major.wishOrder}
                            ${wishResult.passed && result.admitted && result.admittedMajor.code === wishResult.major.code ? ' üèÜ' : ''}
                        </td>
                        <td data-label="Tr∆∞·ªùng">${wishResult.major.school}</td>
                        <td data-label="Ng√†nh">${wishResult.major.name}</td>
                        <td data-label="T·ªï h·ª£p">${wishResult.isValidCombination ? wishResult.bestCombination : 'N/A'}</td>
                        <td data-label="ƒêi·ªÉm c·ªßa b·∫°n" style="font-weight: bold;">${wishResult.isValidCombination ? wishResult.bestScore.toFixed(3) : 'N/A'}</td>
                        <td data-label="ƒêC 2025" style="font-weight: bold; color: #337ab7;">${wishResult.cutoff2025.toFixed(2)}</td>
                        <td data-label="ƒêi·ªÅu ki·ªán">To√°n ‚â• ${wishResult.major.minMath}</td>
                        <td data-label="K·∫øt qu·∫£">
                            <span style="color: ${statusColor}; font-weight: bold;">${statusText}</span>
                            <br><small style="color: ${statusColor}; font-size: 9px;">${reason}</small>
                        </td>
                    </tr>
                `;
            });
            
            html += `</tbody></table></div>`;
            
            // Th√¥ng tin ƒëi·ªÉm chi ti·∫øt
            const subject1Name = getSubjectName(document.getElementById('subject1').value);
            const subject2Name = getSubjectName(document.getElementById('subject2').value);
            const selectedArea = document.getElementById('areaSelect').value;
            const areaText = {
                'KV1': 'KV1 - X√£ mi·ªÅn n√∫i (+0.75)',
                'KV2NT': 'KV2-NT - Khu v·ª±c 2 n√¥ng th√¥n (+0.5)', 
                'KV2': 'KV2 - Th·ªã x√£, th√†nh ph·ªë t·ªânh (+0.25)',
                'KV3': 'KV3 - Qu·∫≠n n·ªôi th√†nh TT TW (0)'
            };
            
            html += `
                <div style="margin-top: 12px; background: #f8f9fa; padding: 8px; border-radius: 3px; font-size: 10px;">
                    <h5 style="margin-bottom: 5px;">üìã TH√îNG TIN X√âT TUY·ªÇN:</h5>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px;">
                        <p><strong>üë§ Th√≠ sinh:</strong> ${currentUserName}</p>
                        <p><strong>üìê To√°n:</strong> ${scores.toan}</p>
                        <p><strong>üìñ Ng·ªØ vƒÉn:</strong> ${scores.van}</p>
                        <p><strong>üéØ ${subject1Name}:</strong> ${scores[document.getElementById('subject1').value]}</p>
                        <p><strong>üéØ ${subject2Name}:</strong> ${scores[document.getElementById('subject2').value]}</p>
                        <p><strong>üèòÔ∏è Khu v·ª±c:</strong> ${areaText[selectedArea]}</p>
                        <p><strong>‚ûï ƒêi·ªÉm ∆∞u ti√™n:</strong> ${result.allResults[0] ? result.allResults[0].areaBonus.toFixed(3) : 'N/A'}</p>
                        <p><strong>üí∞ Thanh to√°n:</strong> ${(wishList.length * 15000).toLocaleString('vi-VN')} VNƒê</p>
                    </div>
                </div>
            `;
            
            modalBody.innerHTML = html;
            modal.style.display = 'block';
            
            // Hi·ªÉn th·ªã c√°c n√∫t b·ªï sung
            document.getElementById('viewCutoff2025Btn').style.display = 'inline-block';
            document.getElementById('viewRandomRatesBtn').style.display = 'inline-block';
        }

        // L·∫•y t√™n ƒë·∫ßy ƒë·ªß c·ªßa tr∆∞·ªùng
        function getSchoolFullName(school) {
            const fullNames = {
                'UIT': 'TR∆Ø·ªúNG ƒê·∫†I H·ªåC C√îNG NGH·ªÜ TH√îNG TIN<br>ƒê·∫†I H·ªåC QU·ªêC GIA TP. H·ªí CH√ç MINH',
                'HCMUS': 'TR∆Ø·ªúNG ƒê·∫†I H·ªåC KHOA H·ªåC T·ª∞ NHI√äN<br>ƒê·∫†I H·ªåC QU·ªêC GIA TP. H·ªí CH√ç MINH',
                'SPKT': 'TR∆Ø·ªúNG ƒê·∫†I H·ªåC S∆Ø PH·∫†M K·ª∏ THU·∫¨T<br>TH√ÄNH PH·ªê H·ªí CH√ç MINH',
                'FPT': 'TR∆Ø·ªúNG ƒê·∫†I H·ªåC FPT<br>TH√ÄNH PH·ªê H·ªí CH√ç MINH'
            };
            return fullNames[school] || school;
        }

        // Hi·ªÉn th·ªã B·∫¢NG ƒêI·ªÇM CHU·∫®N 2025
        function showCutoff2025() {
            if (!admissionProcessed) {
                alert('‚ö†Ô∏è B·∫°n c·∫ßn x√©t tuy·ªÉn tr∆∞·ªõc ƒë·ªÉ xem ƒëi·ªÉm chu·∫©n 2025!');
                return;
            }
            
            const modal = document.getElementById('cutoff2025Modal');
            const tableBody = document.getElementById('cutoff2025TableBody');
            
            let html = '';
            allMajors.sort((a,b) => b.cutoff2024 - a.cutoff2024).forEach((major, index) => {
                const cutoffKey = major.school + '_' + major.code;
                const cutoff2025Value = cutoff2025Generated[cutoffKey];
                const change = cutoff2025Value - major.cutoff2024;
                const changeText = change >= 0 ? `+${change.toFixed(2)}` : `${change.toFixed(2)}`;
                const changeColor = change === 0 ? '#666' : (change >= 0 ? '#d9534f' : '#5cb85c');
                const changeIcon = change === 0 ? '‚ûñ' : (change >= 0 ? 'üìà' : 'üìâ');
                
                html += `
                    <tr>
                        <td data-label="STT">${index + 1}</td>
                        <td data-label="Tr∆∞·ªùng" style="font-weight: bold;">${major.school}</td>
                        <td data-label="M√£ ng√†nh">${major.code}</td>
                        <td data-label="T√™n ng√†nh">${major.name}</td>
                        <td data-label="ƒêC 2024">${major.cutoff2024.toFixed(2)}</td>
                        <td data-label="ƒêC 2025" style="font-weight: bold; color: #337ab7;">${cutoff2025Value.toFixed(2)}</td>
                        <td data-label="So s√°nh" style="color: ${changeColor}; font-weight: bold;">
                            ${changeIcon} ${changeText}
                            ${major.school === 'FPT' ? '<br><small>(Kh√¥ng random)</small>' : ''}
                        </td>
                    </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            modal.style.display = 'block';
        }
        
        // Hi·ªÉn th·ªã T·ª∂ L·ªÜ RANDOM
        function showRandomRates() {
            if (!admissionProcessed) {
                alert('‚ö†Ô∏è B·∫°n c·∫ßn x√©t tuy·ªÉn tr∆∞·ªõc ƒë·ªÉ xem t·ª∑ l·ªá random!');
                return;
            }
            
            const modal = document.getElementById('randomRatesModal');
            modal.style.display = 'block';
        }

        // C·∫≠p nh·∫≠t dropdown ng√†nh cho t·ª∑ l·ªá random
        function updateRandomMajorSelect() {
            const schoolSelect = document.getElementById('randomSchoolSelect');
            const majorSelect = document.getElementById('randomMajorSelect');
            
            majorSelect.innerHTML = '<option value="">-- Ch·ªçn ng√†nh --</option>';
            
            if (schoolSelect.value) {
                majorSelect.disabled = false;
                const schoolMajors = allMajors.filter(m => m.school === schoolSelect.value && m.probabilities !== null);
                schoolMajors.forEach(major => {
                    const option = document.createElement('option');
                    option.value = major.school + '_' + major.code;
                    option.textContent = `${major.name} (${major.code})`;
                    majorSelect.appendChild(option);
                });
                
                if (schoolMajors.length === 0) {
                    const option = document.createElement('option');
                    option.value = '';
                    option.textContent = '-- FPT kh√¥ng c√≥ random --';
                    majorSelect.appendChild(option);
                }
            } else {
                majorSelect.disabled = true;
            }
        }

        // Hi·ªÉn th·ªã t·ª∑ l·ªá random c·ªßa ng√†nh
        function showMajorRandomRate() {
            const schoolSelect = document.getElementById('randomSchoolSelect');
            const majorSelect = document.getElementById('randomMajorSelect');
            const display = document.getElementById('randomRateDisplay');
            
            if (!schoolSelect.value || !majorSelect.value) {
                if (schoolSelect.value === 'FPT') {
                    display.innerHTML = `
                        <div style="background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 5px; padding: 15px; text-align: center;">
                            <h5 style="color: #337ab7; margin-bottom: 10px;">üè´ ƒê·∫†I H·ªåC FPT TPHCM</h5>
                            <div style="background: #d1ecf1; padding: 10px; border-radius: 3px; margin: 10px 0;">
                                <strong>üìä CH√çNH S√ÅCH ƒêI·ªÇM CHU·∫®N ƒê·∫∂C BI·ªÜT:</strong>
                            </div>
                            <p style="margin: 8px 0;"><strong>üéØ ƒêi·ªÉm chu·∫©n 2024:</strong> 21.00 ƒëi·ªÉm (t·∫•t c·∫£ ng√†nh)</p>
                            <p style="margin: 8px 0;"><strong>üéØ ƒêi·ªÉm chu·∫©n 2025:</strong> 21.00 ƒëi·ªÉm (gi·ªØ nguy√™n)</p>
                            <div style="background: #dff0d8; padding: 10px; border-radius: 3px; margin: 10px 0;">
                                <strong>‚úÖ FPT KH√îNG RANDOM - GI·ªÆ NGUY√äN ƒêI·ªÇM CHU·∫®N</strong><br>
                                <small>Tr∆∞·ªùng FPT cam k·∫øt ·ªïn ƒë·ªãnh ƒëi·ªÉm chu·∫©n ƒë·ªÉ t·∫°o ƒëi·ªÅu ki·ªán cho th√≠ sinh</small>
                            </div>
                        </div>
                    `;
                } else {
                    alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn tr∆∞·ªùng v√† ng√†nh!');
                }
                return;
            }
            
            const [school, code] = majorSelect.value.split('_');
            const major = allMajors.find(m => m.school === school && m.code === code);
            
            if (major && major.probabilities) {
                const prob = major.probabilities;
                const cutoffKey = major.school + '_' + major.code;
                const actualCutoff2025 = cutoff2025Generated[cutoffKey];
                const change = actualCutoff2025 - major.cutoff2024;
                
                let html = `
                    <div style="background: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 5px; padding: 15px;">
                        <h5 style="color: #337ab7; margin-bottom: 10px;">üìä ${major.name} (${major.code})</h5>
                        <p style="margin-bottom: 8px;"><strong>üè´ Tr∆∞·ªùng:</strong> ${major.school}</p>
                        <p style="margin-bottom: 8px;"><strong>üìà ƒêi·ªÉm chu·∫©n 2024:</strong> ${major.cutoff2024.toFixed(2)}</p>
                        <p style="margin-bottom: 8px;"><strong>üéØ ƒêi·ªÉm chu·∫©n 2025:</strong> ${actualCutoff2025.toFixed(2)} 
                            <span style="color: ${change >= 0 ? '#d9534f' : '#5cb85c'}; font-weight: bold;">
                                (${change >= 0 ? '+' : ''}${change.toFixed(2)})
                            </span>
                        </p>
                        
                        <h6 style="margin: 15px 0 10px 0; color: #666;">üé≤ T·ª∂ L·ªÜ RANDOM C·ª¶A CH√öNG T√îI:</h6>
                        <table class="data-table" style="font-size: 9px;">
                            <thead>
                                <tr>
                                    <th>Kho·∫£ng thay ƒë·ªïi</th>
                                    <th>T·ª∑ l·ªá (%)</th>
                                    <th>Tr·∫°ng th√°i</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ${prob.decrease_over_025 > 0 ? 'style="background: #f2dede;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">Gi·∫£m > 0.25 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.decrease_over_025}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.decrease_over_025 > 0 ? 'üî¥ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.decrease_0_025 > 0 ? 'style="background: #fcf8e3;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">Gi·∫£m 0-0.25 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.decrease_0_025}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.decrease_0_025 > 0 ? 'üü° C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.increase_0_025 > 0 ? 'style="background: #d1ecf1;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">TƒÉng 0-0.25 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.increase_0_025}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.increase_0_025 > 0 ? 'üîµ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.increase_025_05 > 0 ? 'style="background: #d1ecf1;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">TƒÉng 0.25-0.5 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.increase_025_05}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.increase_025_05 > 0 ? 'üîµ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.increase_05_075 > 0 ? 'style="background: #d4edda;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">TƒÉng 0.5-0.75 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.increase_05_075}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.increase_05_075 > 0 ? 'üü¢ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.increase_075_1 > 0 ? 'style="background: #d4edda;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">TƒÉng 0.75-1.0 ƒëi·ªÉm</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.increase_075_1}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.increase_075_1 > 0 ? 'üü¢ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                                <tr ${prob.increase_over_1 > 0 ? 'style="background: #f8d7da;"' : ''}>
                                    <td data-label="Kho·∫£ng thay ƒë·ªïi">TƒÉng > 1.0 ƒëi·ªÉm (t·ªëi ƒëa 1.5)</td>
                                    <td data-label="T·ª∑ l·ªá (%)" style="font-weight: bold;">${prob.increase_over_1}%</td>
                                    <td data-label="Tr·∫°ng th√°i">${prob.increase_over_1 > 0 ? 'üî¥ C√≥ th·ªÉ' : '‚ö´ Kh√¥ng'}</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div style="margin-top: 10px; padding: 8px; background: #e7f3ff; border-radius: 3px; font-size: 10px;">
                            <strong>üí° Gi·∫£i th√≠ch:</strong> T·ª∑ l·ªá d·ª±a tr√™n ph√¢n t√≠ch xu h∆∞·ªõng tuy·ªÉn sinh 2025[24][27][47].
                        </div>
                    </div>
                `;
                
                display.innerHTML = html;
            }
        }

        // Confetti animation
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd', '#ff9ff3', '#54a0ff'];
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-10px';
                    confetti.style.width = Math.random() * 8 + 5 + 'px';
                    confetti.style.height = Math.random() * 8 + 5 + 'px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    confetti.style.pointerEvents = 'none';
                    confetti.style.zIndex = '9999';
                    confetti.style.animation = `fall ${3 + Math.random() * 2}s linear forwards`;
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            confetti.parentNode.removeChild(confetti);
                        }
                    }, 5000);
                }, i * 20);
            }
        }

        // Utilities
        function getSubjectName(code) {
            const names = {
                'anh': 'Ti·∫øng Anh', 'ly': 'V·∫≠t l√Ω', 'hoa': 'H√≥a h·ªçc', 'sinh': 'Sinh h·ªçc',
                'su': 'L·ªãch s·ª≠', 'dia': 'ƒê·ªãa l√Ω', 'gdkt': 'GDKT & PL', 'tin': 'Tin h·ªçc', 'congnghe': 'C√¥ng ngh·ªá'
            };
            return names[code] || code;
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // D·ªØ li·ªáu m·∫´u
        function fillSampleData() {
            document.getElementById('toan').value = '8.8';
            document.getElementById('van').value = '8.0';
            document.getElementById('subject1').value = 'ly';
            document.getElementById('score1').disabled = false;
            document.getElementById('score1').value = '9.0';
            document.getElementById('subject2').value = 'anh';
            document.getElementById('score2').disabled = false;
            document.getElementById('score2').value = '9.2';
            
            wishList = [];
            // D·ªØ li·ªáu m·∫´u t·ª´ file PDF
            const sampleMajors = [
                { school: 'UIT', code: '7480101' },
                { school: 'HCMUS', code: '7480105' }, // Mapping 7480101_TT to existing 7480105
                { school: 'UIT', code: '7480103' },
                { school: 'UIT', code: '7520207' }, // Mapping 752020a1 to existing 7520207
                { school: 'HCMUS', code: 'QHT16' }, // Mapping 75202a1 to K·ªπ thu·∫≠t ƒêi·ªán t·ª≠ - Vi·ªÖn th√¥ng
                { school: 'HCMUS', code: 'QHT01' }, // Mapping 7440102_NN to new QHT01
                { school: 'UIT', code: '7480106' },
                { school: 'HCMUS', code: 'QHT14' }, // Mapping 7480201_NN to new QHT14
                { school: 'UIT', code: '7480202' },
                { school: 'UIT', code: '7480102' },
                { school: 'UIT', code: '7480104' },
                { school: 'HCMUS', code: 'QHT12' }, // Mapping 7460108_NN to new QHT12
                { school: 'UIT', code: '7460108' }
            ];
            
            sampleMajors.forEach((sample, index) => {
                const major = allMajors.find(m => m.school === sample.school && m.code === sample.code);
                if (major) {
                    wishList.push({
                        ...major, 
                        wishOrder: index + 1
                    });
                } else {
                    console.warn(`Sample major not found: ${sample.school} - ${sample.code}`);
                }
            });
            
            renderWishList();
            updateWishStats();
            updatePaymentInfo();
            checkGeminiButtons();
            showToast('‚úÖ ƒê√£ ƒëi·ªÅn d·ªØ li·ªáu m·∫´u theo h·ªì s∆° UTXT!');
        }

        function resetAll() {
            if (confirm('üîÑ Reset t·∫•t c·∫£ d·ªØ li·ªáu v√† b·∫Øt ƒë·∫ßu l·∫°i?')) {
                document.getElementById('scoreForm').reset();
                document.getElementById('score1').disabled = true;
                document.getElementById('score2').disabled = true;
                document.getElementById('schoolSelect').value = '';
                document.getElementById('majorSelect').innerHTML = '<option value="">-- Ch·ªçn ng√†nh --</option>';
                document.getElementById('majorSelect').disabled = true;
                document.getElementById('areaSelect').value = 'KV2NT';
                
                wishList = [];
                cutoff2025Generated = {};
                admissionProcessed = false;
                paymentCompleted = false;
                
                renderWishList();
                updateWishStats();
                updatePaymentInfo();
                updateAreaInfo();
                checkGeminiButtons();
                
                document.getElementById('paymentSection').style.display = 'none';
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('viewCutoff2025Btn').style.display = 'none';
                document.getElementById('viewRandomRatesBtn').style.display = 'none';
                
                // Reset t√™n v·ªÅ m·∫∑c ƒë·ªãnh
                currentUserName = 'NGUY·ªÑN VƒÇN A';
                document.getElementById('userName').textContent = currentUserName;
                document.getElementById('userNameInfo').textContent = currentUserName;
                cancelEditName();
                
                // Reset c√°c th√¥ng tin c√° nh√¢n kh√°c
                document.getElementById('studentId').textContent = '123456';
                document.getElementById('birthPlace').textContent = 'H√† N·ªôi';
                document.getElementById('highSchool').textContent = 'THPT Hogwarts';
                
                showToast('‚úÖ ƒê√£ reset ho√†n to√†n h·ªá th·ªëng!');
            }
        }
        
        // =================================================
        // =========== GEMINI API INTEGRATION ==============
        // =================================================

        const API_KEY = "AIzaSyBKkBFi9YpHb8-xXvSxXTT1Plx8WgHHImM"; // API Key ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;

        // H√†m ki·ªÉm tra v√† k√≠ch ho·∫°t c√°c n√∫t Gemini
        function checkGeminiButtons() {
            const majorInfoBtn = document.getElementById('geminiMajorInfoBtn');
            const strategyBtn = document.getElementById('geminiStrategyBtn');
            
            // K√≠ch ho·∫°t n√∫t "T√¨m hi·ªÉu ng√†nh" khi c√≥ ng√†nh ƒë∆∞·ª£c ch·ªçn
            const majorSelect = document.getElementById('majorSelect');
            if (majorSelect.value) {
                majorInfoBtn.disabled = false;
            } else {
                majorInfoBtn.disabled = true;
            }

            // K√≠ch ho·∫°t n√∫t "T∆∞ v·∫•n" khi c√≥ ƒëi·ªÉm v√† √≠t nh·∫•t 1 NV
            const scores = getScores();
            const hasAllScores = scores.toan && scores.van && scores[document.getElementById('subject1').value] && scores[document.getElementById('subject2').value];
            if (hasAllScores && wishList.length > 0) {
                strategyBtn.disabled = false;
            } else {
                strategyBtn.disabled = true;
            }
        }

        // H√†m g·ªçi API Gemini v·ªõi exponential backoff
        async function callGeminiAPI(prompt, maxRetries = 3) {
            let attempt = 0;
            let delay = 1000; // 1 second
            
            while(attempt < maxRetries) {
                try {
                    const payload = {
                        contents: [{
                            parts: [{ text: prompt }]
                        }]
                    };
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error("Invalid response structure from Gemini API");
                    }
                } catch (error) {
                    console.error(`Attempt ${attempt + 1} failed:`, error);
                    attempt++;
                    if (attempt < maxRetries) {
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2; // Double the delay for the next retry
                    } else {
                        return "R·∫•t ti·∫øc, ƒë√£ c√≥ l·ªói x·∫£y ra khi k·∫øt n·ªëi v·ªõi Tr·ª£ l√Ω AI. Vui l√≤ng th·ª≠ l·∫°i sau.";
                    }
                }
            }
        }
        
        // Hi·ªÉn th·ªã modal loading c·ªßa Gemini
        function showGeminiLoading(title) {
            const modal = document.getElementById('geminiModal');
            document.getElementById('geminiModalTitle').textContent = title;
            document.getElementById('geminiModalBody').innerHTML = `
                <div class="loading-gemini">
                    <div class="spinner"></div>
                    <p>Tr·ª£ l√Ω AI ƒëang ph√¢n t√≠ch, vui l√≤ng ch·ªù trong gi√¢y l√°t...</p>
                </div>
            `;
            modal.style.display = 'block';
        }

        // L·∫•y th√¥ng tin ng√†nh h·ªçc
        async function getMajorInfo() {
            const majorSelect = document.getElementById('majorSelect');
            if (!majorSelect.value) return;

            const [school, code] = majorSelect.value.split('_');
            const major = allMajors.find(m => m.school === school && m.code === code);
            if (!major) return;

            const schoolFullName = getSchoolFullName(school).replace(/<br>/g, ' - ');
            showGeminiLoading(`‚ú® T√¨m hi·ªÉu v·ªÅ ng√†nh ${major.name}`);

            const prompt = `H√£y cung c·∫•p m·ªôt b·∫£n t√≥m t·∫Øt v·ªÅ ng√†nh '${major.name}' t·∫°i tr∆∞·ªùng '${schoolFullName}'. N·ªôi dung bao g·ªìm: c√°c m√¥n h·ªçc c·ªët l√µi, c∆° h·ªôi vi·ªác l√†m sau khi ra tr∆∞·ªùng, v√† nh·ªØng k·ªπ nƒÉng quan tr·ªçng c·∫ßn c√≥ cho ng√†nh n√†y. Tr√¨nh b√†y d∆∞·ªõi d·∫°ng c√°c g·∫°ch ƒë·∫ßu d√≤ng ng·∫Øn g·ªçn, d·ªÖ hi·ªÉu.`;
            
            const responseText = await callGeminiAPI(prompt);
            document.getElementById('geminiModalBody').innerHTML = responseText.replace(/\n/g, '<br>');
        }

        // L·∫•y t∆∞ v·∫•n chi·∫øn l∆∞·ª£c
        async function getStrategicAdvice() {
            if (!validateForm() || wishList.length === 0) {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·ªß ƒëi·ªÉm v√† th√™m √≠t nh·∫•t 1 nguy·ªán v·ªçng ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n!');
                return;
            }
            
            showGeminiLoading('‚ú® Chuy√™n gia AI ƒëang t∆∞ v·∫•n chi·∫øn l∆∞·ª£c');

            const scores = getScores();
            let scoresText = `To√°n: ${scores.toan}, Ng·ªØ vƒÉn: ${scores.van}`;
            const subject1 = document.getElementById('subject1').value;
            const subject2 = document.getElementById('subject2').value;
            scoresText += `, ${getSubjectName(subject1)}: ${scores[subject1]}, ${getSubjectName(subject2)}: ${scores[subject2]}.`;

            const wishListText = wishList.map(w => 
                `NV${w.wishOrder}: Tr∆∞·ªùng ${w.school} - Ng√†nh ${w.name} (ƒêi·ªÉm chu·∫©n 2024: ${w.cutoff2024})`
            ).join('\n');

            const prompt = `B·∫°n l√† m·ªôt chuy√™n gia t∆∞ v·∫•n tuy·ªÉn sinh ƒë·∫°i h·ªçc gi√†u kinh nghi·ªám t·∫°i Vi·ªát Nam. D·ª±a v√†o th√¥ng tin ƒëi·ªÉm thi v√† danh s√°ch nguy·ªán v·ªçng d∆∞·ªõi ƒë√¢y c·ªßa m·ªôt h·ªçc sinh, h√£y ƒë∆∞a ra nh·ªØng ph√¢n t√≠ch v√† l·ªùi khuy√™n chi·∫øn l∆∞·ª£c. H√£y nh·∫≠n x√©t v·ªÅ m·ª©c ƒë·ªô 'an to√†n', 'ph√π h·ª£p', v√† 'tham v·ªçng' c·ªßa t·ª´ng nguy·ªán v·ªçng. ƒê·ªÅ xu·∫•t c√°ch s·∫Øp x·∫øp l·∫°i nguy·ªán v·ªçng (n·∫øu c·∫ßn) ƒë·ªÉ t·ªëi ∆∞u h√≥a c∆° h·ªôi tr√∫ng tuy·ªÉn. L·ªùi khuy√™n c·∫ßn c·ª• th·ªÉ, mang t√≠nh x√¢y d·ª±ng v√† kh√≠ch l·ªá.
            ---
            ƒêi·ªÉm thi c·ªßa h·ªçc sinh: ${scoresText}
            ---
            Danh s√°ch nguy·ªán v·ªçng:
            ${wishListText}
            ---
            H√£y tr√¨nh b√†y c√¢u tr·∫£ l·ªùi d∆∞·ªõi d·∫°ng HTML c√≥ c·∫•u tr√∫c r√µ r√†ng, s·ª≠ d·ª•ng th·∫ª <strong>, <ul>, <li> ƒë·ªÉ d·ªÖ ƒë·ªçc.`;

            const responseText = await callGeminiAPI(prompt);
            document.getElementById('geminiModalBody').innerHTML = responseText;
        }
        
        // AI S·∫Øp x·∫øp nguy·ªán v·ªçng
        function populateAiWishSelectors() {
            const selector1 = document.getElementById('aiWish1');
            const selector2 = document.getElementById('aiWish2');
            selector1.innerHTML = '<option value="">-- Ch·ªçn nguy·ªán v·ªçng m∆° ∆∞·ªõc 1 --</option>';
            selector2.innerHTML = '<option value="">-- Ch·ªçn nguy·ªán v·ªçng m∆° ∆∞·ªõc 2 --</option>';

            allMajors.forEach(major => {
                const option = document.createElement('option');
                option.value = `${major.school}_${major.code}`;
                option.textContent = `${major.school} - ${major.name}`;
                selector1.appendChild(option.cloneNode(true));
                selector2.appendChild(option);
            });
        }

        async function getAiArrangement() {
            const wish1 = document.getElementById('aiWish1').value;
            const wish2 = document.getElementById('aiWish2').value;

            if (!validateForm()) {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·ªß ƒëi·ªÉm thi tr∆∞·ªõc khi nh·ªù AI s·∫Øp x·∫øp!');
                return;
            }
            if (!wish1 || !wish2) {
                alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn ƒë·ªß 2 nguy·ªán v·ªçng m∆° ∆∞·ªõc!');
                return;
            }
            if (wish1 === wish2) {
                alert('‚ö†Ô∏è Vui l√≤ng ch·ªçn 2 nguy·ªán v·ªçng kh√°c nhau!');
                return;
            }

            showGeminiLoading('‚ú® AI ƒëang x√¢y d·ª±ng chi·∫øn l∆∞·ª£c cho b·∫°n...');

            const scores = getScores();
            let scoresText = `To√°n: ${scores.toan}, Ng·ªØ vƒÉn: ${scores.van}`;
            const subject1 = document.getElementById('subject1').value;
            const subject2 = document.getElementById('subject2').value;
            scoresText += `, ${getSubjectName(subject1)}: ${scores[subject1]}, ${getSubjectName(subject2)}: ${scores[subject2]}.`;
            
            const allMajorsText = allMajors.map(m => `${m.school}|${m.code}|${m.name}|${m.cutoff2024}`).join('\n');

            const prompt = `B·∫°n l√† m·ªôt chuy√™n gia t∆∞ v·∫•n tuy·ªÉn sinh ƒë·∫°i h·ªçc. D·ª±a v√†o ƒëi·ªÉm thi c·ªßa h·ªçc sinh, 2 nguy·ªán v·ªçng m∆° ∆∞·ªõc c·ªßa h·ªç, v√† danh s√°ch t·∫•t c·∫£ c√°c ng√†nh c√≥ th·ªÉ ch·ªçn, h√£y t·∫°o ra m·ªôt danh s√°ch g·ªìm 8 ƒë·∫øn 10 nguy·ªán v·ªçng ƒë∆∞·ª£c s·∫Øp x·∫øp theo chi·∫øn l∆∞·ª£c 3 t·∫ßng: M∆° ∆∞·ªõc, V·ª´a s·ª©c, An to√†n.
            
            QUY T·∫ÆC:
            1.  **B·∫Øt bu·ªôc bao g·ªìm** 2 nguy·ªán v·ªçng m∆° ∆∞·ªõc m√† h·ªçc sinh ƒë√£ ch·ªçn ·ªü c√°c v·ªã tr√≠ ƒë·∫ßu ti√™n.
            2.  **Ch·ªâ ch·ªçn** c√°c ng√†nh t·ª´ danh s√°ch ƒë∆∞·ª£c cung c·∫•p.
            3.  **Chi·∫øn l∆∞·ª£c 3 t·∫ßng:**
                * **M∆° ∆∞·ªõc (2-3 NV):** Bao g·ªìm 2 NV h·ªçc sinh ƒë√£ ch·ªçn v√† c√≥ th·ªÉ th√™m 1 NV kh√°c c√≥ ƒëi·ªÉm chu·∫©n 2024 cao h∆°n ƒëi·ªÉm thi.
                * **V·ª´a s·ª©c (3-4 NV):** C√°c ng√†nh li√™n quan c√≥ ƒëi·ªÉm chu·∫©n 2024 x·∫•p x·ªâ ho·∫∑c th·∫•p h∆°n m·ªôt ch√∫t so v·ªõi ƒëi·ªÉm thi.
                * **An to√†n (2-3 NV):** C√°c ng√†nh c√≥ ƒëi·ªÉm chu·∫©n 2024 th·∫•p h∆°n ƒë√°ng k·ªÉ so v·ªõi ƒëi·ªÉm thi ƒë·ªÉ ƒë·∫£m b·∫£o kh·∫£ nƒÉng tr√∫ng tuy·ªÉn.
            4.  **ƒê·ªãnh d·∫°ng ƒë·∫ßu ra:** Ch·ªâ tr·∫£ v·ªÅ m·ªôt m·∫£ng JSON h·ª£p l·ªá. M·ªói ƒë·ªëi t∆∞·ª£ng trong m·∫£ng ph·∫£i c√≥ hai key l√† "school" v√† "code". V√≠ d·ª•: [{"school": "UIT", "code": "7480101"}, {"school": "SPKT", "code": "7480201_N"}]. Kh√¥ng th√™m b·∫•t k·ª≥ vƒÉn b·∫£n gi·∫£i th√≠ch n√†o kh√°c.

            ---
            **Th√¥ng tin ƒë·∫ßu v√†o:**
            1.  **ƒêi·ªÉm thi c·ªßa h·ªçc sinh:** ${scoresText}
            2.  **Nguy·ªán v·ªçng m∆° ∆∞·ªõc 1:** ${wish1}
            3.  **Nguy·ªán v·ªçng m∆° ∆∞·ªõc 2:** ${wish2}
            4.  **Danh s√°ch t·∫•t c·∫£ c√°c ng√†nh (ƒê·ªãnh d·∫°ng: School|Code|Name|Cutoff2024):**
            ${allMajorsText}
            ---
            
            **Y√™u c·∫ßu ƒë·∫ßu ra:** Ch·ªâ tr·∫£ v·ªÅ m·∫£ng JSON.`;

            const responseText = await callGeminiAPI(prompt);
            
            try {
                // L√†m s·∫°ch output t·ª´ AI, ch·ªâ l·∫•y ph·∫ßn JSON
                const jsonMatch = responseText.match(/\[.*\]/s);
                if (!jsonMatch) throw new Error("AI did not return a valid JSON array.");
                
                const newWishListObjects = JSON.parse(jsonMatch[0]);
                
                wishList = []; // X√≥a danh s√°ch c≈©
                newWishListObjects.forEach((item, index) => {
                    const major = allMajors.find(m => m.school === item.school && m.code === item.code);
                    if (major) {
                        wishList.push({ ...major, wishOrder: index + 1 });
                    }
                });

                renderWishList();
                updateWishStats();
                updatePaymentInfo();
                checkGeminiButtons();
                closeModal('geminiModal');
                showToast('‚úÖ AI ƒë√£ s·∫Øp x·∫øp xong danh s√°ch nguy·ªán v·ªçng cho b·∫°n!');

            } catch (error) {
                console.error("Error parsing AI response:", error);
                document.getElementById('geminiModalBody').innerHTML = `<p style="color: red;">R·∫•t ti·∫øc, AI ƒë√£ tr·∫£ v·ªÅ k·∫øt qu·∫£ kh√¥ng h·ª£p l·ªá. Vui l√≤ng th·ª≠ l·∫°i.</p><p style="font-size: 10px; color: #666;">L·ªói: ${error.message}</p>`;
            }
        }


        // ƒê√≥ng modal khi click b√™n ngo√†i
        window.onclick = function(event) {
            const modals = ['resultModal', 'cutoff2024Modal', 'cutoff2025Modal', 'randomRatesModal', 'guideModal', 'geminiModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                if (!document.getElementById('submitBtn').disabled) {
                    processAdmissionComplete();
                }
            }
            if (e.key === 'Escape') {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (modal.style.display === 'block') {
                        modal.style.display = 'none';
                    }
                });
            }
            if (e.key === 'F1') {
                e.preventDefault();
                showGuide();
            }
            if (e.key === 'F2') {
                e.preventDefault();
                editName();
            }
        });

        // CSS animation cho confetti
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(360deg);
                }
            }
        `;
        document.head.appendChild(style);

        // Th√¥ng b√°o khi t·∫£i trang
        window.addEventListener('load', function() {
            setTimeout(() => {
                console.log('üéì H·ªá th·ªëng x√©t tuy·ªÉn ƒêH 2025 ƒë√£ t·∫£i ho√†n t·∫•t!');
                console.log('‚ú® ' + allMajors.length + ' ng√†nh t·ª´ 4 tr∆∞·ªùng: UIT (' + uitMajors.length + '), HCMUS (' + hcmusMajors.length + '), SPKT (' + spktMajors.length + '), FPT (' + fptMajors.length + ')');
                console.log('üîß Hotkeys: Ctrl+Enter (n·ªôp), Esc (ƒë√≥ng modal), F1 (h∆∞·ªõng d·∫´n), F2 (s·ª≠a t√™n)');
                console.log('üìä V·ªõi ƒëi·ªÉm chu·∫©n 2024 ch√≠nh x√°c t·ª´ t√¨m ki·∫øm[24][27][47]');
            }, 1000);
        });

    </script>
</body>
</html>